__d(function(e,t,a,n){function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(a,n){var r=t||{},T=e===q.SECTION_PENDING,E={pending:T},i={entity:q.ENTITY_SECTION,id:e,loadingKey:(0,$.getLoadingKey)(r)};if(a({type:Q.SET_LOADING,meta:babelHelpers.extends({},i,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),r.more){var o=(0,W.rootSelector)(n());E.offset=o.getIn(["entitiesIdMapping",q.ENTITY_SECTION,e],[]).length}return J.fetchTripsSummary(E).then(function(t){var n=t.trip_schedules;a({type:Q.SET_LOADING,meta:i,payload:!1}),a({type:Q.UPDATE_ENTITIES,meta:{entity:q.ENTITY_TRIP_SCHEDULE,idMappingEntity:q.ENTITY_SECTION,id:e,updateType:r.more?q.UPDATE_TYPE_MERGE:q.UPDATE_TYPE_SET},payload:(0,F.normalize)((0,Z.parseTripSchedules)(t.trip_schedules),X.arrayOfTripSchedules)}),a(T?{type:Q.SET_VERIFICATION_FLAGS,payload:(0,Z.parseVerification)(t.metadata)}:{type:Q.UPDATE_CAN_FETCH_MORE,payload:0!==n.length})}).catch(function(){a({type:Q.SET_LOADING,meta:babelHelpers.extends({},i,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!0)}),payload:!1})})}}function T(){return function(e){var t={entity:q.ENTITY_SECTION,id:q.SECTION_UPCOMING_AND_PAST};return e({type:Q.SET_LOADING,meta:t,payload:!0}),J.fetchTripsSummary().then(function(t){e({type:Q.SYNC_TRIP_SCHEDULES,payload:(0,F.normalize)((0,Z.parseTripSchedules)(t.trip_schedules),X.arrayOfTripSchedules)})}).catch(function(){e({type:Q.SET_LOADING,meta:t,payload:!1})})}}function E(e){var t={entity:q.ENTITY_TRIP_SCHEDULE,id:e};return function(a){return a({type:Q.SET_LOADING,meta:babelHelpers.extends({},t,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),J.fetchTripSchedule(e).then(function(e){a({type:Q.SET_LOADING,meta:t,payload:!1}),a({type:Q.UPDATE_ENTITIES,meta:t,payload:(0,F.normalize)((0,Z.parseTripSchedule)(e),X.tripScheduleSchema)})}).catch(function(){a({type:Q.SET_LOADING,meta:babelHelpers.extends({},t,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!0)}),payload:!1})})}}function i(e){var t={entity:q.ENTITY_TRIP_SCHEDULE,id:e};return function(a){return a({type:Q.SET_LOADING,meta:babelHelpers.extends({},t,{toasts:babelHelpers.defineProperty({},B.FETCH_ITINERARY_FAILED_TOAST,!1)}),payload:!0}),J.fetchTripScheduleCards(e).then(function(n){a({type:Q.SET_LOADING,meta:t,payload:!1}),a({type:Q.UPDATE_ENTITIES,meta:{entity:q.ENTITY_CARD,idMappingEntity:q.ENTITY_TRIP_SCHEDULE,id:e},payload:(0,F.normalize)((0,Z.parseTripScheduleCards)(n),X.arraOfCards)})}).catch(function(){a({type:Q.SET_LOADING,meta:babelHelpers.extends({},t,{toasts:babelHelpers.defineProperty({},B.FETCH_ITINERARY_FAILED_TOAST,!0)}),payload:!1})})}}function o(e){return function(t){var a={entity:q.ENTITY_IMMERSION,id:e,idMappingEntity:q.ENTITY_IMMERSION};return t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),J.fetchImmersion(e).then(function(n){t({type:Q.SET_LOADING,meta:a,payload:!1}),t({type:Q.UPDATE_ENTITIES,meta:a,payload:(0,F.normalize)((0,Z.parseImmersion)(babelHelpers.extends({},n,{confirmation_code:e})),X.immersionSchema)})}).catch(function(){t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!0)}),payload:!1})})}}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(a){var n={entity:q.ENTITY_HOME_RESERVATION,id:e,idMappingEntity:q.ENTITY_HOME_RESERVATION,loadingKey:t.loadingKey||q.LOADING_KEY_DEFAULT};return a({type:Q.SET_LOADING,meta:babelHelpers.extends({},n,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),J.fetchReservation(e,t).then(function(e){a({type:Q.SET_LOADING,meta:n,payload:!1}),a({type:Q.UPDATE_ENTITIES,meta:n,payload:(0,F.normalize)((0,Z.parseReservation)(e),X.reservationSchema)})}).catch(function(e){var t=e.error_code===k.HTTP_FORBIDDEN?B.PERMISSION_DENIED_TOAST:B.FETCH_FAILED_TOAST;a({type:Q.SET_LOADING,meta:babelHelpers.extends({},n,{toasts:babelHelpers.defineProperty({},t,!0)}),payload:!1})})}}function _(e){return function(t){var a={entity:q.ENTITY_CANCELLATION_POLICY,id:e};return t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),J.fetchCancellationPolicy(e).then(function(e){t({type:Q.SET_LOADING,meta:a,payload:!1}),t({type:Q.UPDATE_ENTITIES,meta:a,payload:(0,F.normalize)((0,Z.parseCancellationPolicy)(e),X.cancellationPolicySchema)})}).catch(function(){t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!0)}),payload:!1})})}}function c(e){return function(t){var a={entity:q.ENTITY_EXPERIENCE_RESERVATION,id:e,idMappingEntity:q.ENTITY_EXPERIENCE_RESERVATION};return t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),J.fetchExperienceReservation(e).then(function(e){t({type:Q.SET_LOADING,meta:a,payload:!1}),t({type:Q.UPDATE_ENTITIES,meta:a,payload:(0,F.normalize)((0,Z.parseExperienceReservation)(e),X.experienceReservationSchema)})}).catch(function(){t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!0)}),payload:!1})})}}function I(e){return function(t){var a={entity:q.ENTITY_PLACE_RESERVATION,id:e,idMappingEntity:q.ENTITY_PLACE_RESERVATION};return t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),J.fetchPlaceReservation(e).then(function(e){t({type:Q.SET_LOADING,meta:a,payload:!1}),t({type:Q.UPDATE_ENTITIES,meta:a,payload:(0,F.normalize)((0,Z.parsePlaceReservation)(e),X.placeReservationSchema)})}).catch(function(){t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!0)}),payload:!1})})}}function l(e,t,a,n){return function(r){var T={entity:q.ENTITY_CARD,id:n},E={ends_at:a.format(),starts_at:t.format()};return r({type:Q.SET_LOADING,meta:T,payload:!0}),J.fetchRecommendationCards(e,E).then(function(e){r({type:Q.SET_LOADING,meta:T,payload:!1}),0!==e.length&&r({type:Q.UPDATE_ENTITIES,meta:{entity:q.ENTITY_RECOMMENDATION_CARD,idMappingEntity:q.ENTITY_CARD,id:n},payload:(0,F.normalize)((0,Z.parseRecommendationCards)(e),X.arrayOfRecommendationCards)})}).catch(function(){r({type:Q.SET_LOADING,meta:T,payload:!1})})}}function s(e){return function(t){var a={entity:q.ENTITY_HOME_RESERVATION_RECEIPT,id:e};return t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!1)}),payload:!0}),J.fetchHomeReservationReceipt(e).then(function(n){t({type:Q.SET_LOADING,meta:a,payload:!1}),t({type:Q.UPDATE_ENTITIES,meta:a,payload:(0,F.normalize)((0,Z.parseHomeReservationReceipt)(e,n),X.homeReservationReceiptSchema)})}).catch(function(){t({type:Q.SET_LOADING,meta:babelHelpers.extends({},a,{toasts:babelHelpers.defineProperty({},B.FETCH_FAILED_TOAST,!0)}),payload:!1})})}}function d(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(n){var r={cardType:q.PLACE_CARD,entity:q.ENTITY_PLACE_RESERVATION,loadingKey:q.LOADING_KEY_DELETE,id:t,tripScheduleConfirmationCode:e};return n({type:Q.SET_LOADING,meta:babelHelpers.extends({},r,{toasts:babelHelpers.defineProperty({},B.REMOVE_PLACE_FAILED_TOAST,!1)}),payload:!0}),J.deletePlaceReservation(t).then(function(){if(n({type:Q.SET_LOADING,meta:r,payload:!1}),a.isSourceNative)w.default.onPlaceRemoved(t),M.default.dismiss();else{var E=(0,$.getIdForCard)(q.PLACE_CARD,t);n({type:Q.REMOVE_ENTITIES,payload:{entities:[[q.ENTITY_CARD,E],[q.ENTITY_PLACE_RESERVATION,t]],entitiesIdMapping:[[q.ENTITY_TRIP_SCHEDULE,e,E]],lastSyncedAt:[[q.ENTITY_TRIP_SCHEDULE,e]]}}),n(T()),a.source===q.SCREEN_T2&&M.default.dismiss()}}).catch(function(){n({type:Q.SET_LOADING,meta:babelHelpers.extends({},r,{toasts:babelHelpers.defineProperty({},B.REMOVE_PLACE_FAILED_TOAST,!0)}),payload:!1})})}}function A(){return function(e){return e((0,U.removeToast)(B.ACCEPT_TOS_FAILED_TOAST)),J.updateUser(K.default.user().id,{mt_tos_accepted:!0}).then(function(){e(r(q.SECTION_PENDING)),e(r(q.SECTION_UPCOMING_AND_PAST))}).catch(function(){e((0,U.addToast)(B.ACCEPT_TOS_FAILED_TOAST))})}}function y(e){return function(t,a){var n=(0,W.timelineIndividualContainerSelector)(a(),{confirmationCode:e}),r=n.cards;t({type:Q.REMOVE_ENTITIES,payload:{entities:[[q.ENTITY_TRIP_SCHEDULE,e]].concat(babelHelpers.toConsumableArray((r||[]).map(function(e){return[q.ENTITY_CARD,e.id]}))),entitiesIdMapping:[[q.ENTITY_SECTION,q.SECTION_UPCOMING_AND_PAST,e]].concat(babelHelpers.toConsumableArray((r||[]).map(function(t){return[q.ENTITY_TRIP_SCHEDULE,e,t.id]}))),lastSyncedAt:[[q.ENTITY_TRIP_SCHEDULE,e]]}})}}function S(e,t){return function(a){var n=e.trip_schedule_confirmation_code;t&&(n!==t&&a(y(t)),a(N(n))),a(E(n)),a(i(n)),a(r(q.SECTION_UPCOMING_AND_PAST))}}function u(){return function(e){K.default.presentIdentityFlow(K.default.VERIFICATION_FLOW.MAGICAL_TRIPS_BOOKING).then(function(t){t?(e({type:Q.CLEAR_TRIP_SCHEDULES}),e(r(q.SECTION_PENDING)),e(r(q.SECTION_UPCOMING_AND_PAST))):e((0,U.addToast)(B.IDENTITY_FAILED_TOAST))}).catch(function(){e((0,U.addToast)(B.IDENTITY_FAILED_TOAST))})}}function N(e){return{type:Q.SET_VISIBLE_TRIP_SCHEDULE,payload:e}}function f(e){return function(t){J.acceptTripInvite(e).then(function(){t({type:Q.ACCEPT_TRIP_INVITE,payload:e}),t({type:Q.CLEAR_TRIP_SCHEDULES}),t(r(q.SECTION_PENDING)),t(r(q.SECTION_UPCOMING_AND_PAST))}).catch(function(){t((0,U.addToast)(B.ACCEPT_TRIP_INVITE_FAILED_TOAST))})}}function O(){return function(e){Y.AsyncStorage.getItem(q.ITINERARY_CACHE_KEY,function(t,a){if(!t&&a){var n=void 0;try{n=JSON.parse(a)}catch(e){}n&&e({type:Q.REHYDRATE,payload:n})}})}}function C(){return function(e,t){var a=(0,W.rootSelector)(t());Y.AsyncStorage.setItem(q.ITINERARY_CACHE_KEY,JSON.stringify({itinerary:a}),function(){return e({type:Q.CACHE_DATA})})}}function D(){return function(e){Y.AsyncStorage.removeItem(q.ITINERARY_CACHE_KEY,function(){return e({type:Q.CLEAR_CACHE})})}}function R(){return function(e){e((0,U.removeToasts)(B.TOASTS))}}function m(){return function(e){e((0,U.addToast)(B.NATIVE_ALTERATION_DISABLED_TOAST))}}function L(){return function(e){e((0,U.addToast)(B.NATIVE_CANCELATION_DISABLED_TOAST))}}function P(){return function(e){e((0,U.addToast)(B.NATIVE_CANCELATION_ALREADY_ACCEPTED_TOAST))}}function b(){return function(e){e((0,U.addToast)(B.NATIVE_NETWORK_ERROR_TOAST))}}function h(e,t,a){return e({type:Q.SET_LOADING,payload:a,meta:{entity:q.ENTITY_HOME_RESERVATION,id:t,loadingKey:q.LOADING_KEY_APPLE_WALLET}})}function H(e,t){return function(a){h(a,e,!0),V.default.createPass(t).then(function(t){t||a((0,U.addToast)(B.APPLE_WALLET_FAILED_TOAST)),h(a,e,!1)})}}function v(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=void 0,T=void 0,E=void 0;switch(e){case q.EXPERIENCE_CARD:r=q.ENTITY_EXPERIENCE_RESERVATION,T=(0,Z.parseExperienceReservation)(t),E=X.experienceReservationSchema;break;case q.CHECKIN_CARD:case q.CHECKOUT_CARD:case q.HOME_CARD:r=q.ENTITY_HOME_RESERVATION,T=(0,Z.parseReservation)(t),E=X.reservationSchema;break;case q.IMMERSION_CARD:r=q.ENTITY_IMMERSION,T=(0,Z.parseImmersion)(t),E=X.immersionSchema;break;case q.PLACE_CARD:r=q.ENTITY_PLACE_RESERVATION,T=(0,Z.parsePlaceReservation)(t),E=X.placeReservationSchema}return function(e){var t={entity:r,id:a,idMappingEntity:r,loadingKey:n.loadingKey||q.LOADING_KEY_DEFAULT};e({type:Q.UPDATE_ENTITIES,meta:t,payload:(0,F.normalize)(T,E)})}}Object.defineProperty(n,"__esModule",{value:!0}),n.fetchTripsSummary=r,n.syncTripSchedules=T,n.fetchTripSchedule=E,n.fetchTripScheduleCards=i,n.fetchImmersion=o,n.fetchHomeReservation=p,n.fetchCancellationPolicy=_,n.fetchExperienceReservation=c,n.fetchPlaceReservation=I,n.fetchRecommendationCards=l,n.fetchHomeReservationReceipt=s,n.removePlaceFromTimeline=d,n.acceptMtTOS=A,n.removeTripSchedule=y,n.addPlaceToItinerarySucceeded=S,n.presentIdentityFlow=u,n.setVisibleTripSchedule=N,n.acceptTripInvite=f,n.rehydrate=O,n.cacheData=C,n.clearCache=D,n.clearToasts=R,n.showNativeAlterationDisabledToast=m,n.showNativeCancelationDisabledToast=L,n.showNativeCancelationAlreadyAcceptedToast=P,n.showNativeNetworkErrorToast=b,n.addToAppleWallet=H,n.updateReservationObjectContent=v;var Y=t(44),F=t(1931),G=t(410),M=babelHelpers.interopRequireDefault(G),U=t(684),g=t(1935),V=babelHelpers.interopRequireDefault(g),x=t(376),K=babelHelpers.interopRequireDefault(x),z=t(725),w=babelHelpers.interopRequireDefault(z),W=t(1936),q=t(1818),B=t(1941),k=t(1942),X=t(1943),j=t(1944),J=babelHelpers.interopRequireWildcard(j),Q=t(1945),Z=t(1946),$=t(1937)},1930);