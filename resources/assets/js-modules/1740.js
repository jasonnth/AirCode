__d(function(e,t,a,r){Object.defineProperty(r,"__esModule",{value:!0});var s=t(271),o=babelHelpers.interopRequireDefault(s),l=t(834),i=t(44),n=t(782),u=babelHelpers.interopRequireDefault(n),f=t(1741),d=babelHelpers.interopRequireDefault(f),m=t(379),p=babelHelpers.interopRequireDefault(m),h=t(890),b=babelHelpers.interopRequireDefault(h),c=t(410),v=babelHelpers.interopRequireDefault(c),y=t(1032),T=babelHelpers.interopRequireDefault(y),R=t(1051),N=babelHelpers.interopRequireDefault(R),S=t(1023),g=t(1352),H=babelHelpers.interopRequireDefault(g),C=t(881),w=babelHelpers.interopRequireDefault(C),D=t(839),A=babelHelpers.interopRequireDefault(D),x=t(756),P=babelHelpers.interopRequireDefault(x),B=t(1742),E=babelHelpers.interopRequireDefault(B),q=t(1743),V=babelHelpers.interopRequireDefault(q),j=t(376),_=babelHelpers.interopRequireDefault(j),F=t(1575),k=t(1609),L=t(772),I=babelHelpers.interopRequireDefault(L),O={firstName:l.Types.string,lastName:l.Types.string,email:l.Types.string,travelerCount:l.Types.number.isRequired,otherTravelers:l.Types.array,onChange:l.Types.func,onRemove:l.Types.func,newTraveler:l.Types.bool,priceString:l.Types.string,isMounted:l.Types.func.isRequired},z={newTraveler:!1,onChange:function(){},onRemove:function(){},otherTravelers:[]},M="android"===i.Platform.OS,U=function(e){function t(a,r){babelHelpers.classCallCheck(this,t);var s=babelHelpers.possibleConstructorReturn(this,e.call(this,a,r));return s.state={firstName:a.firstName,lastName:a.lastName,email:a.email,firstNameDirty:!1,lastNameDirty:!1,emailDirty:!1,sheetVisible:!1,showToast:!1,showImportContactsButton:!1,footerBottom:new i.Animated.Value(a.newTraveler?80:0)},s.onSheetVisibleChange=s.onSheetVisibleChange.bind(s),s.setScrollScreen=s.setScrollScreen.bind(s),s.onAddTravelerPress=s.onAddTravelerPress.bind(s),s.onRemoveTravelerPress=s.onRemoveTravelerPress.bind(s),s.onSelectContact=s.onSelectContact.bind(s),s.setFirstNameRef=s.setFirstNameRef.bind(s),s.setLastNameRef=s.setLastNameRef.bind(s),s.setEmailRef=s.setEmailRef.bind(s),s}return babelHelpers.inherits(t,e),t.prototype.componentWillMount=function(){var e=this;M||d.default.checkPermission(function(t,a){"undefined"!==a&&"authorized"!==a||e.props.isMounted()&&e.setState({showImportContactsButton:!0})})},t.prototype.componentWillUpdate=function(e,t){var a=this.state.firstName&&this.state.lastName&&this.state.email,r=t.firstName&&t.lastName&&t.email;!a&&r&&this.scrollUpFooter()},t.prototype.scrollUpFooter=function(){i.Animated.timing(this.state.footerBottom,{toValue:0,duration:250}).start()},t.prototype.onSheetVisibleChange=function(e){if(this.props.isMounted()){if(this.setState({sheetVisible:e}),e)return void(this.state.firstName&&this.state.lastName&&this.state.email&&this.scrollUpFooter());this.props.newTraveler&&this.setState({firstName:void 0,lastName:void 0,email:void 0,firstNameDirty:!1,lastNameDirty:!1,emailDirty:!1,emailSameAsUser:!1,emailSameAsOtherTraveler:!1,showToast:!1,footerBottom:new i.Animated.Value(80)})}},t.prototype.onAddTravelerPress=function(){var e=this.state,t=e.firstName,a=e.lastName,r=e.email;this.addTraveler(t,a,r),(0,k.logBookingFlowConfirmAddGuest)()},t.prototype.onRemoveTravelerPress=function(){this.props.onRemove(),v.default.dismiss(),(0,k.logBookingFlowRemoveGuest)()},t.prototype.onSelectContact=function(e){var t=e.givenName,a=e.familyName,r=e.emailAddresses,s=r.length>0&&r[0].email;this.setState({firstName:t,lastName:a,email:s})},t.prototype.addTraveler=function(e,t,a){var r=_.default.user(),s=this.props.otherTravelers,o=r.email&&a&&r.email.toLowerCase()===a.toLowerCase(),l=a&&s.filter(function(e){return e.email&&e.email.toLowerCase()===a.toLowerCase()}).length>0;this.setState({firstName:e,lastName:t,email:a,emailSameAsUser:o,emailSameAsOtherTraveler:l}),e&&t&&a&&!o&&!l?(this.props.onChange({firstName:e,lastName:t,email:a}),v.default.dismiss()):this.setState({showToast:!0})},t.prototype.setScrollScreen=function(e){this.scrollScreen=e},t.prototype.setFirstNameRef=function(e){this.firstNameRef=e},t.prototype.setLastNameRef=function(e){this.lastNameRef=e},t.prototype.setEmailRef=function(e){this.emailRef=e},t.prototype.toastMessage=function(){var e=this.state,t=e.firstName,a=e.lastName,r=e.email,s=e.emailSameAsUser,o=e.emailSameAsOtherTraveler,l=null,i=0;return t||(l=p.default.phrase("Please add a first name.",null,"error message"),i+=1),a||(l=p.default.phrase("Please add a last name.",null,"error message"),i+=1),r||(l=p.default.phrase("Please add an email address.",null,"error message"),i+=1),i>1&&(l=p.default.phrase("Please add the guest\u2019s information.",null,"error message")),s&&(l=p.default.phrase("You can\u2019t add yourself as an additional traveler",null,"error message")),o&&(l=p.default.phrase("Traveler already added",null,"error message")),l},t.prototype.renderSheet=function(){var e=this,t=this.state,a=t.firstName,r=t.lastName,s=t.email,l=t.showToast,n=t.firstNameDirty,u=t.lastNameDirty,f=t.emailDirty,d=this.props,m=d.travelerCount,h=d.newTraveler,c=p.default.phrase("Guest %{smart_count} |||| Guest %{smart_count}",{smart_count:m+1},"Header for the form for traveler entry"),y=p.default.phrase("This is so your guest can confirm their spot. Make sure to enter their actual information.",null,"Subtitle for the cotraveler entry form"),T=!!(a&&r&&s);return babelHelpers.jsx(b.default,{visible:this.state.sheetVisible,onVisibleChange:this.onSheetVisibleChange},void 0,babelHelpers.jsx(I.default,{title:c,footer:T&&babelHelpers.jsx(i.Animated.View,{style:{transform:[{translateY:this.state.footerBottom}]}},void 0,babelHelpers.jsx(w.default,{buttonText:h?p.default.phrase("Add guest",null,"button text to add traveler"):p.default.phrase("Save",null,"button text to save traveler info"),onButtonPress:this.onAddTravelerPress,title:h?null:p.default.phrase("Remove",null,"button text to remove a traveler"),onSecondaryActionPress:this.onRemoveTravelerPress})),toastsUseRedux:!1,toasts:[l&&babelHelpers.jsx(H.default,{id:F.ADD_TRAVELER_ERROR_TOAST,title:this.toastMessage(),error:!0,onClosePress:function(){return e.setState({showToast:!1})}},F.ADD_TRAVELER_ERROR_TOAST)]},void 0,babelHelpers.jsx(v.default.Screen,{barType:v.default.Screen.BAR_TYPE.BASIC}),babelHelpers.jsx(P.default,{style:G.description},void 0,y),h&&this.state.showImportContactsButton&&babelHelpers.jsx(V.default,{onSelectContact:this.onSelectContact}),o.default.createElement(N.default,{style:G.sheetInput,label:p.default.phrase("First name",null,"form input label for first name"),type:"text",dark:!0,returnKeyType:"next",ref:this.setFirstNameRef,value:a,error:!a&&n,onChangeText:function(t){return e.setState({firstName:t,showToast:!1,firstNameDirty:!0})},onSubmitEditing:function(){return e.lastNameRef.focus()}}),o.default.createElement(N.default,{style:G.sheetInput,label:p.default.phrase("Last name",null,"form input label for last name"),type:"text",dark:!0,returnKeyType:"next",ref:this.setLastNameRef,value:r,error:!r&&u,onChangeText:function(t){return e.setState({lastName:t,showToast:!1,lastNameDirty:!0})},onSubmitEditing:function(){return e.emailRef.focus()}}),o.default.createElement(N.default,{style:G.sheetInput,label:p.default.phrase("Email address",null,"form input label for email address"),type:"email",dark:!0,returnKeyType:"done",ref:this.setEmailRef,value:s,onChangeText:function(t){return e.setState({email:t,showToast:!1,emailDirty:!0})},error:!s&&f,onSubmitEditing:this.onAddTravelerPress})))},t.prototype.render=function(){var e=this,t=this.props,a=t.firstName,r=t.lastName,s=t.newTraveler,o=a&&r,l=o?p.default.phrase("%{firstName} %{lastName}",{firstName:a,lastName:r},"traveler full name"):p.default.phrase("Your friend",null,"used in place of friend\u2019s name if none is entered");if(!s)return babelHelpers.jsx(i.View,{},void 0,this.renderSheet(),babelHelpers.jsx(T.default,{title:l,actionTitle:p.default.phrase("Edit",null,"Button to edit traveler info"),onPress:function(){return e.setState({sheetVisible:!0})}}));var n=p.default.phrase("Add another guest",null,"Button to add another traveler");return babelHelpers.jsx(i.View,{},void 0,this.renderSheet(),babelHelpers.jsx(E.default,{title:n,icon:"add",onPress:function(){e.setState({sheetVisible:!0}),(0,k.logBookingFlowClickAddAnotherGuest)()}}))},t}(o.default.Component);U.propTypes=O,U.defaultProps=z;var G=S.ThemedStyleSheet.create(function(e){var t=e.bp,a=e.color,r=e.font,s=e.size;return{sheetInput:{paddingHorizontal:s.baseRow.paddingHorizontal},containerShadow:A.default.footer,description:{marginBottom:s.vertical.small,paddingHorizontal:s.baseRow.paddingHorizontal},sheetFooter:{position:"absolute",paddingHorizontal:s.horizontal.medium,alignItems:"center",bottom:0,left:0,right:0,flexDirection:"row",justifyContent:"flex-end",backgroundColor:"white",height:10*t},sheetFooterEdit:{justifyContent:"space-between"},addButton:babelHelpers.extends({},r.footerButton,{color:a.core.rausch}),removeButton:babelHelpers.extends({},r.footerButton,{color:a.dark.hof})}});r.default=(0,u.default)(U)},1740);