__d(function(e,t,i,o){Object.defineProperty(o,"__esModule",{value:!0});var n=t(759),r=babelHelpers.interopRequireDefault(n),a=t(412),l=babelHelpers.interopRequireDefault(a),s=t(271),u=babelHelpers.interopRequireDefault(s),d=t(654),c=t(1497),p=babelHelpers.interopRequireDefault(c),f=t(379),I=babelHelpers.interopRequireDefault(f),h=t(790),T=t(410),b=babelHelpers.interopRequireDefault(T),E=t(1475),C=babelHelpers.interopRequireWildcard(E),_=t(1489),N=babelHelpers.interopRequireDefault(_),R=t(1498),O=babelHelpers.interopRequireDefault(R),V=t(1499),D=babelHelpers.interopRequireDefault(V),m=t(1500),F=babelHelpers.interopRequireDefault(m),P=t(1501),A=babelHelpers.interopRequireDefault(P),y=t(1470),S=t(1502),g=t(1466),H=t(1472),v=t(1443),q=t(684),k=t(1503),x=t(1478),L=function(e){function t(i){babelHelpers.classCallCheck(this,t);var o=babelHelpers.possibleConstructorReturn(this,e.call(this,i));return o.state={isLoading:!1},o.phoneNumberOptions=(0,S.getPhoneNumberOptions)(o.getVerificationDetail()),o.verifyCode=o.verifyCode.bind(o),o.setCodeInputScreenRef=o.setCodeInputScreenRef.bind(o),o.onCloseToast=o.onCloseToast.bind(o),o.onFailedFriction=o.onFailedFriction.bind(o),o.onTryAgain=o.onTryAgain.bind(o),o.getSubtitle=o.getSubtitle.bind(o),o}return babelHelpers.inherits(t,e),t.prototype.setCodeInputScreenRef=function(e){this.codeInputScreenRef=e},t.prototype.verifyCode=function(e){var t=this,i=this.props,o=i.actionName,n=i.airlockId,r=i.userId,a=i.frictionType,l=i.selectedPhoneNumberId,s=i.submitPhoneVerificaitonCode;return(0,i.removeAllToasts)(),(0,p.default)(),(0,x.logSubmitPhoneVerificationCode)(n,a,e),s({actionName:o,airlockId:n,userId:r,frictionType:a,phoneNumberId:l,code:e}).then(function(e){var i=e.success,o=e.payload;return t.handleSubmissionResult(i,o)})},t.prototype.handleSubmissionResult=function(e,t){return!e||(!0===((t.airlock||{}).friction_statuses||{})[this.props.frictionType]?((0,p.default)(),b.default.push(v.FRICTION_SUCCESS),!0):(this.props.addToast(H.PHONE_VERIFICATION_WRONG_CODE),!1))},t.prototype.getVerificationDetail=function(){var e=this.props,t=e.frictionType,i=e.phoneVerificationViaCallDetail,o=e.phoneVerificationViaTextDetail;return t===g.FRICTION_TYPE_PHONE_VERIFICATION_VIA_TEXT?o:i},t.prototype.getSelectedPhoneNumberOption=function(){var e=this.props.selectedPhoneNumberId;return this.phoneNumberOptions.find(function(t){return t.value===e})||{}},t.prototype.getTryAgainHint=function(){return this.props.frictionType===g.FRICTION_TYPE_PHONE_VERIFICATION_VIA_TEXT?I.default.phrase("Resend code.",null,"A link to send the phone verification code again"):I.default.phrase("Try again",null,"A link to get the verification code from phone call again")},t.prototype.getSubtitle=function(){var e=this.getSelectedPhoneNumberOption().label;return this.props.frictionType===g.FRICTION_TYPE_PHONE_VERIFICATION_VIA_TEXT?I.default.phrase("We sent your code to %{obfascatedNumber}. It might take a minute or two for the text to arrive.",{obfascatedNumber:e},"a subtitle explaining where to find the verification code"):I.default.phrase("You\u2019ll get a call at %{obfascatedNumber}. It might take a minute or two for the call to come through.",{obfascatedNumber:e},"a subtitle explaining where to find the verification code")},t.prototype.onCloseToast=function(){this.props.removeAllToasts(),this.codeInputScreenRef.clearInput(),this.codeInputScreenRef.focus()},t.prototype.onTryAgain=function(){var e=this,t=this.props,i=t.actionName,o=t.airlockId,n=t.userId,r=t.selectedPhoneNumberId,a=t.frictionType,l=t.requestToSendPhoneVerificationCode;(0,x.logSendPhoneVerificationCode)(o,x.PAGE_NAMES.PHONE_CODE_INPUT_SCREEN,r,a),l({actionName:i,airlockId:o,userId:n,phoneNumberId:r,frictionType:a}).then(function(t){var i=t.success,o=t.payload;i||("rate_limit"===o.error_type?e.props.addToast(H.PHONE_VERIFICATION_RESEND_CODE_RATE_LIMITED):e.props.addToast(H.PHONE_VERIFICATION_RESEND_CODE_FAILED))})},t.prototype.onFailedFriction=function(){this.props.addFailedFriction(this.props.frictionType)},t.prototype.render=function(){var e=this.props.isFetching,t=this.getTryAgainHint();return u.default.createElement(O.default,{ref:this.setCodeInputScreenRef,title:I.default.phrase("Enter your verification code",null,"Screen title for the user to input verification code sent to phone"),subtitle:this.getSubtitle(),hintTryAgain:t,retryInterval:k.VERIFICATION_CODE_RESEND_INTERVAL_SECONDS,codeLength:k.VERIFICATION_CODE_LENGTH,isLoading:e,funcFailed:this.onFailedFriction,funcTryAgain:this.onTryAgain,funcVerifyCode:this.verifyCode,toasts:[babelHelpers.jsx(A.default,{id:H.PHONE_VERIFICATION_WRONG_CODE,onPressClose:this.onCloseToast},H.PHONE_VERIFICATION_WRONG_CODE),babelHelpers.jsx(F.default,{id:H.PHONE_VERIFICATION_SUBMIT_CODE_FAILED,onPressClose:this.onCloseToast},H.PHONE_VERIFICATION_SUBMIT_CODE_FAILED),babelHelpers.jsx(F.default,{id:H.PHONE_VERIFICATION_RESEND_CODE_FAILED,onPressClose:this.onCloseToast},H.PHONE_VERIFICATION_RESEND_CODE_FAILED),babelHelpers.jsx(D.default,{id:H.PHONE_VERIFICATION_RESEND_CODE_RATE_LIMITED,onPressClose:this.onCloseToast},H.PHONE_VERIFICATION_RESEND_CODE_RATE_LIMITED)]})},t}(s.PureComponent);L.propTypes={isFetching:l.default.bool,airlockId:l.default.number,actionName:l.default.string,userId:l.default.number,phoneVerificationViaCallDetail:N.default,phoneVerificationViaTextDetail:N.default,selectedPhoneNumberId:l.default.number,frictionType:l.default.oneOf(g.FRICTION_GROUP_PHONE_VERIFICATION).isRequired,addFailedFriction:l.default.func.isRequired,submitPhoneVerificaitonCode:l.default.func.isRequired,requestToSendPhoneVerificationCode:l.default.func.isRequired,addToast:l.default.func.isRequired,removeAllToasts:l.default.func.isRequired},L.defaultProps={isFetching:!1,airlockId:null,actionName:null,userId:null,phoneVerificationViaCallDetail:null,phoneVerificationViaTextDetail:null,selectedPhoneNumberId:null},o.default=(0,h.connect)(function(e){return babelHelpers.extends({phoneVerificationViaCallDetail:(0,y.phoneVerificationViaCallDetailSelector)(e),phoneVerificationViaTextDetail:(0,y.phoneVerificationViaTextDetailSelector)(e)},(0,r.default)((0,y.frictionManagerSelector)(e),["airlockId","actionName","userId"]),(0,r.default)((0,y.phoneVerificationSelector)(e),["selectedPhoneNumberId","frictionType","isFetching"]))},function(e){return(0,d.bindActionCreators)({addFailedFriction:C.addFailedFriction,submitPhoneVerificaitonCode:C.submitPhoneVerificaitonCode,requestToSendPhoneVerificationCode:C.requestToSendPhoneVerificationCode,removeAllToasts:C.removeAllToasts,addToast:q.addToast},e)})(L)},1496);