__d(function(e,t,r,n){function i(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=t(727),l=i(s),d=t(2332),c=t(2337),f=i(c),h=t(2340),p=i(h),v=t(2342),m=i(v),b="batch",y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.host,n=void 0===r?"bessie":r,i=t.withScopedAuth,a=void 0!==i&&i,o=t.includeReadStatus,s=void 0!==o&&o;u(this,e),this.resource=new l.default(b,{host:n}),this.limit=d.DEFAULT_PAGE_SIZE,this.withScopedAuth=a,this.includeReadStatus=s}return o(e,[{key:"pollForUpdates",value:function(){function e(e){var t=this;return e?this.resource.create(null,{operations:this.buildOperations(e)}).then(function(e){return t.parseResponse(e)}):Promise.resolve({})}return e}()},{key:"buildOperations",value:function(){function e(e){var t=e.id,r=e.meta;return[m.default.buildOperation(t),p.default.buildOperation({threadID:t,withScopedAuth:this.withScopedAuth,limit:this.limit,forwardCursor:(r||{})[d.FORWARD_CURSOR]})].concat(a(this.includeReadStatus?[f.default.buildOperation(t)]:[]))}return e}()},{key:"parseResponse",value:function(){function e(e){var t=e.operations,r=void 0===t?[]:t,n=m.default.parseOperation(r[0]),i=p.default.parseOperation(e.operations[1],this.resource.getBaseUrl(),this.resource.getHeaders()),a=i.meta,u=i.olderItemsAvailable,o=i.newerItemsToUpsert;return{threadStatus:n,readStatusMap:f.default.parseOperation(r[2]),olderItemsAvailable:u,meta:a,newerItemsToUpsert:o}}return e}()},{key:"setLimit",value:function(){function e(e){this.limit=e}return e}()},{key:"setHeaders",value:function(){function e(e){this.resource.setHeaders(e)}return e}()}]),e}();n.default=y},2336);