__d(function(e,t,r,a){function i(e){var t=e.name,r=e.imageUrl,a=e.onPress;return babelHelpers.jsx(u.TouchableOpacity,{onPress:a},void 0,babelHelpers.jsx(u.View,{style:M.destinationCard},void 0,babelHelpers.jsx(u.Image,{style:M.destinationCardImage,source:{uri:r}}),babelHelpers.jsx(u.Text,{style:M.destinationCardText},void 0,t)))}function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=[],i=e,n=void 0,s=1;if(!t||!i)return[i];for(;-1!==(n=i.toLowerCase().indexOf(t.toLowerCase()))&&(a.push(i.slice(0,n),i.slice(n,n+t.length)),i=i.slice(n+t.length),!((s+=1)>r)););return a.concat(i).filter(Boolean)}function s(e,t,r){return r?e===t:e.toLowerCase()===t.toLowerCase()}Object.defineProperty(a,"__esModule",{value:!0});var o=t(412),l=babelHelpers.interopRequireDefault(o),p=t(271),d=babelHelpers.interopRequireDefault(p),u=t(44),c=t(654),h=t(790),b=t(410),f=babelHelpers.interopRequireDefault(b),y=t(841),g=babelHelpers.interopRequireDefault(y),x=t(422),T=babelHelpers.interopRequireDefault(x),H=t(1032),v=babelHelpers.interopRequireDefault(H),R=t(778),w=babelHelpers.interopRequireDefault(R),m=t(779),S=babelHelpers.interopRequireDefault(m),D=t(1497),j=babelHelpers.interopRequireDefault(D),C=t(2281),q=babelHelpers.interopRequireDefault(C),L=t(379),V=babelHelpers.interopRequireDefault(L),P=t(823),B=babelHelpers.interopRequireDefault(P),k=t(2441),_=babelHelpers.interopRequireWildcard(k),I=t(1482),A=babelHelpers.interopRequireWildcard(I),E=t(2443),O=babelHelpers.interopRequireDefault(E),W=new O.default;i.propTypes={name:l.default.string.isRequired,imageUrl:l.default.string.isRequired,onPress:l.default.func.isRequired};var U=function(e){function t(r,a){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,e.call(this,r,a));i.typeaheadSearch=(0,q.default)(function(e){return i.props.typeaheadSearch(e)},200);var n=new u.ListView.DataSource({rowHasChanged:function(e,t){return e.join("/")!==t.join("/")}});return i.ds=n,i.state={typeaheadDatasource:n.cloneWithRows([])},i.setTextRowRef=i.setTextRowRef.bind(i),i}return babelHelpers.inherits(t,e),t.prototype.componentWillReceiveProps=function(e){var t=this.state.inputText,r=e.typeaheads[t]||[];this.setState({typeaheadDatasource:this.ds.cloneWithRows(r.map(function(e){return n(e,t)}))})},t.prototype.search=function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.$preventSearch){this.props.searchByText(e);var a=r.target||"unknown";W.log("search",{target:a,text:e},["target"]),(0,j.default)(),f.default.push(A.SEARCHED_STORIES,{searchText:e}),setTimeout(function(){return t.props.refreshSearchHistory()},1e3),this.$preventSearch=!0,setTimeout(function(){return t.$preventSearch=!1},500)}},t.prototype.componentDidMount=function(){W.log("impression"),this.props.refreshSearchHistory(),this.props.initTopDestinations()},t.prototype.setTextRowRef=function(e){this.textRowRef=e},t.prototype.renderTopDestinations=function(){var e=this,t=this.props,r=t.topDestinations,a=t.isTopDestinationLoading,n=r.length>0;return babelHelpers.jsx(u.View,{},void 0,babelHelpers.jsx(u.View,{style:M.std},void 0,babelHelpers.jsx(u.Text,{small:!0,style:M.sectionTitle},void 0,V.default.phrase("Top Destinations",null,"a section title"))),n&&babelHelpers.jsx(u.ScrollView,{horizontal:!0,showsHorizontalScrollIndicator:!1,keyboardShouldPersistTaps:"always",style:M.destinationView},void 0,r.map(function(t){return babelHelpers.jsx(i,{name:t.name,imageUrl:t.imageUrl,onPress:function(){e.search(t.name,{target:"top_destinations"})}},t.name)})),!n&&a&&babelHelpers.jsx(u.View,{style:[{height:90},M.std]},void 0,babelHelpers.jsx(g.default,{})))},t.prototype.onTextChange=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.typeaheadSearch(e),this.setState({inputText:e})},t.prototype.onAppear=function(){this.textRowRef.focus()},t.prototype.renderSearchHistory=function(){var e=this,t=this.props.recentSearchTexts;return t.length?babelHelpers.jsx(u.View,{style:{paddingBottom:20}},void 0,babelHelpers.jsx(u.View,{style:[M.std,{marginTop:24,flexDirection:"row"}]},void 0,babelHelpers.jsx(u.Text,{small:!0,style:M.sectionTitle},void 0,V.default.phrase("Recent Searches",null,"a section title"))),babelHelpers.jsx(w.default,{},void 0,t.map(function(t){return babelHelpers.jsx(v.default,{micro:!0,noIcon:!0,title:t,onPress:function(){return e.search(t,{target:"recent_search"})}},t)}))):null},t.prototype.render=function(){var e=this,t=this.props.typeaheadLoading,r=void 0===t?{}:t,a=this.state,i=a.inputText,n=void 0===i?"":i,o=a.typeaheadDatasource,l=n.length>0&&r[n];return babelHelpers.jsx(u.View,{style:M.rootContainer},void 0,babelHelpers.jsx(f.default.Screen,{barType:f.default.Screen.BAR_TYPE.BASIC,link:n&&V.default.phrase("Clear",null,"click to clear the text input box"),onLinkPress:function(){return e.onTextChange("")},onAppear:function(){return e.onAppear()}}),babelHelpers.jsx(u.View,{style:M.searchBar},void 0,d.default.createElement(B.default,{ref:this.setTextRowRef,placeholder:V.default.phrase("Search Stories",null,"a text input placeholder"),returnKeyType:"search",onChangeText:function(t){return e.onTextChange(t)},value:n,onSubmitEditing:function(t){var r=t.nativeEvent.text;r.trim()&&e.search(r,{target:"keyboard_enter"})},multiline:!1,alwaysShowPaddedDivider:!0})),0===n.length&&babelHelpers.jsx(u.ScrollView,{style:M.contentView,keyboardDismissMode:"on-drag",keyboardShouldPersistTaps:"always"},void 0,this.renderTopDestinations(),this.renderSearchHistory()),l&&babelHelpers.jsx(u.View,{style:{height:200}},void 0,babelHelpers.jsx(g.default,{})),!l&&o.getRowCount()>0&&babelHelpers.jsx(u.ListView,{style:{paddingTop:20,paddingBottom:20},keyboardDismissMode:"on-drag",keyboardShouldPersistTaps:"always",dataSource:o,renderRow:function(t){return babelHelpers.jsx(S.default,{onPress:function(){return e.search(t.join(""),{target:"typeahead"})}},void 0,babelHelpers.jsx(u.View,{style:{flexDirection:"row"}},void 0,t.map(function(e,t){return babelHelpers.jsx(u.Text,{style:[M.rowTitle,s(e,n)?M.bold:{}]},e+t,e)})))}}))},t}(p.PureComponent);U.propTypes={typeaheadSearch:l.default.func.isRequired,searchByText:l.default.func.isRequired,refreshSearchHistory:l.default.func.isRequired,initTopDestinations:l.default.func.isRequired,typeaheads:l.default.object,recentSearchTexts:l.default.arrayOf(l.default.string),topDestinations:l.default.arrayOf(l.default.shape({name:l.default.string.isRequired,imageUrl:l.default.string.isRequired})),isTopDestinationLoading:l.default.bool,typeaheadLoading:l.default.object},U.defaultProps={typeaheads:[],recentSearchTexts:[],topDestinations:[],typeaheadLoading:{}};var M=T.default.create(function(e){var t=e.bp,r=e.font;return{rootContainer:{flex:1},std:{marginLeft:3*t,marginRight:3*t},sectionTitle:{color:"#c2c2c2",paddingBottom:10},searchBar:{paddingTop:50},contentView:{paddingTop:20},destinationView:{flexDirection:"row"},destinationCard:{marginLeft:3*t,marginRight:2*t,paddingTop:2*t,paddingBottom:t,alignItems:"center"},destinationCardImage:babelHelpers.extends({borderRadius:24,height:48,width:48},"ios"===u.Platform.OS?{backgroundColor:"#dbdbdb"}:{}),destinationCardText:{marginTop:t,color:"#9d9d9d"},rowTitle:babelHelpers.extends({},r.large),bold:{fontWeight:"bold"}}});a.default=(0,h.connect)(function(e){var t=e.stories;return{typeaheads:t.typeaheads,typeaheadLoading:t.typeaheadLoading,recentSearchTexts:t.recentSearchTexts,topDestinations:t.topDestinations,isTopDestinationLoading:t.isTopDestinationLoading}},function(e){return(0,c.bindActionCreators)({typeaheadSearch:_.typeaheadSearch,searchByText:_.searchByText,refreshSearchHistory:_.refreshSearchHistory,initTopDestinations:_.initTopDestinations},e)})(U)},2440);