__d(function(e,t,r,o){function i(e){return e&&e.cover_photos&&e.cover_photos.length>1?e.cover_photos[1].xl_picture:null}function l(e,t){x.default.push(ue.SHARING,{entry_point:"guidebook_detour",id:e.id,url:e.share_url||(0,$.getWebUrl)("/things-to-do/detours/"+e.id),primary_image_url:t,detour_title:e.title,detour_about:e.about,detour_description:e.description,detour_tips:e.tips})}function n(e){return{latitude:parseFloat(e.starting_lat),longitude:parseFloat(e.starting_lng)}}function u(e){return e?e+" "+(0,F.getMoji)(U.default.AIRMOJIS.AIRMOJI_AUDIO_HEADPHONES):null}Object.defineProperty(o,"__esModule",{value:!0});var a=t(271),s=babelHelpers.interopRequireDefault(a),d=t(412),p=babelHelpers.interopRequireDefault(d),b=t(730),f=babelHelpers.interopRequireDefault(b),c=t(44),h=t(654),v=t(790),D=t(1671),H=babelHelpers.interopRequireDefault(D),g=t(379),R=babelHelpers.interopRequireDefault(g),_=t(1366),S=babelHelpers.interopRequireDefault(_),y=t(828),m=babelHelpers.interopRequireDefault(y),q=t(410),x=babelHelpers.interopRequireDefault(q),k=t(1640),E=babelHelpers.interopRequireDefault(k),A=t(841),T=babelHelpers.interopRequireDefault(A),C=t(778),j=babelHelpers.interopRequireDefault(C),I=t(1352),O=babelHelpers.interopRequireDefault(I),P=t(2121),w=babelHelpers.interopRequireDefault(P),M=t(1023),G=t(1390),L=babelHelpers.interopRequireDefault(G),F=t(906),U=babelHelpers.interopRequireDefault(F),B=t(839),N=babelHelpers.interopRequireDefault(B),Y=t(2073),J=babelHelpers.interopRequireDefault(Y),W=t(1038),V=babelHelpers.interopRequireDefault(W),z=t(376),K=babelHelpers.interopRequireDefault(z),Q=t(2035),X=t(2046),Z=t(2088),$=t(1483),ee=t(2084),te=babelHelpers.interopRequireDefault(ee),re=t(2122),oe=babelHelpers.interopRequireDefault(re),ie=t(2123),le=babelHelpers.interopRequireDefault(ie),ne=t(1482),ue=babelHelpers.interopRequireWildcard(ne),ae=t(772),se=babelHelpers.interopRequireDefault(ae),de=t(2093),pe=t(2040),be={detour:oe.default,title:p.default.string,id:J.default.isRequired,pressedCloseGuidebookScreen:p.default.func.isRequired,fetchDetourData:p.default.func.isRequired,searchContextString:p.default.string},fe=function(e){function t(r,o){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,e.call(this,r,o));return i.state={loading:!0,playing:!1},i.videoRef=i.videoRef.bind(i),i.handleMomentumScrollEnd=i.handleMomentumScrollEnd.bind(i),i.currY=0,i}return babelHelpers.inherits(t,e),t.prototype.componentWillMount=function(){var e=this.props.id;this.props.fetchDetourData(e)},t.prototype.componentDidMount=function(){(0,de.logDetourPDPImpressionEvent)(Number(this.props.id),this.props.searchContextString)},t.prototype.videoRef=function(e){this.video=e},t.prototype.handleMomentumScrollEnd=function(e){var t=e.nativeEvent.contentOffset.y,r=t<this.prevY;this.prevY=t,(0,de.logGuidebookScrollDetourPdpEvent)(parseInt(this.props.id,10),r)},t.prototype.render=function(){var e=this,t=this.props,r=t.detour,o=t.title,a=this.state,d=a.loading,p=a.playing,b=this.props.id;b=Number(b);var h=void 0,v=void 0,D=void 0,g=void 0,_=void 0,y=void 0,q=void 0,k=void 0,A=i(r),C=R.default.phrase("Unique audio tours",null,"Title for section describing partnership with detour"),I=R.default.phrase("Airbnb is partnering with Detour to provide self-guided audio walks so you can uncover a city's story at your own pace.",null,"Description of Airbnb's partnership with detour");return r&&(h=r.about,v=r.description,D=r.tips,_=!r.share_uid&&K.default.user()?r.deep_link_url+"?"+f.default.stringify({ref:"Airbnb"}):r.deep_link_url,q=r.starting_address,g=r.title,y=r.preview_audio_url&&r.preview_audio_url.replace("http:","https:"),k=n(r)),babelHelpers.jsx(se.default,{onMomentumScrollEnd:this.handleMomentumScrollEnd,marquee:babelHelpers.jsx(m.default,{title:u(g||o),image:A,subtitle:h,barType:x.default.BAR_TYPE.SPECIALTY,onBackPress:this.props.pressedCloseGuidebookScreen,hideStatusBarUntilFoldOffset:!0},void 0,(0,Z.shouldShowGuidebooksShareSheet)()&&r&&A&&babelHelpers.jsx(V.default,{icon:"share",onPress:function(){return l(r,A)}})),footer:babelHelpers.jsx(c.View,{style:N.default.footer},void 0,babelHelpers.jsx(E.default,{title:"Detour",subtitle:R.default.phrase("Free for Airbnb",null,"the detour is free for Airbnb user"),subtitleNumberOfLines:2,buttonText:R.default.phrase("Open app",null,"click to open the detour in detour app"),onButtonPress:function(){(0,de.logGuidebookClickDetourOpenAppEvent)(b),_&&c.Linking.openURL(_)},buttonDark:!0,buttonMedium:!0,iconForTitle:le.default,buttonSvg:"externalLink"})),toasts:[babelHelpers.jsx(O.default,{id:pe.FETCH_FAILED_TOAST,error:!0,action:R.default.phrase("Retry",null,"a button to retry after connection error"),title:R.default.phrase("Error",null,"title of an error message"),description:R.default.phrase("Unfortunately, a connection error prevented your request from being sent. Please try again.",null,"description of an error message")},pe.FETCH_FAILED_TOAST)]},void 0,babelHelpers.jsx(j.default,{},void 0,!r&&babelHelpers.jsx(T.default,{style:ce.loaderContainer}),!!v&&babelHelpers.jsx(L.default,{title:R.default.phrase("About this tour",null,"title description for an audio guide tour from Detour App"),body:v,divider:"none",onExpandText:function(){return(0,de.logGuidebookClickDetourInfoSectionEvent)(b,"About")}},void 0,!!y&&babelHelpers.jsx(w.default,{icon:p?"video-pause-alt":"video-play-alt",loading:d,onPress:function(){(0,de.logGuidebookClickDetourPreviewEvent)(b),e.setState({playing:!p})},title:R.default.phrase("Preview",null,"button to preview an audio clip"),inverse:!0}),!!y&&s.default.createElement(H.default,{ref:this.videoRef,source:{uri:y},paused:!p,Repeat:!1,onEnd:function(){e.video.seek(0),e.setState({playing:!1})},onLoadStart:function(){return e.setState({loading:!0})},onLoad:function(){return e.setState({loading:!1})},style:ce.video})),!!k&&babelHelpers.jsx(te.default,{airmoji:U.default.AIRMOJIS.AIRMOJI_CORE_STAR_FULL,coordinate:k,markerWithBorder:!0}),!!q&&babelHelpers.jsx(S.default,{},void 0,R.default.phrase("Starting point",null,"starting point(address) of a detour"),babelHelpers.jsx(c.Text,{style:ce.address},void 0,q)),!!D&&babelHelpers.jsx(L.default,{title:R.default.phrase("Tips & hours",null,"Tips and hours for a detour audio trip"),body:D,onExpandText:function(){(0,de.logGuidebookClickDetourInfoSectionEvent)(b,"Tips & hours")}}),babelHelpers.jsx(S.default,{},void 0,C,babelHelpers.jsx(c.Text,{style:ce.address},void 0,I))))},t}(s.default.PureComponent);fe.propTypes=be;var ce=M.ThemedStyleSheet.create(function(e){var t=e.size,r=e.font;return{loaderContainer:{paddingVertical:t.vertical.medium},address:babelHelpers.extends({},r.small,{paddingTop:t.vertical.tiny}),video:{width:0,height:0,overflow:"hidden"}}});o.default=(0,v.connect)(function(e,t){return{detour:(0,X.guidebookDetourSelector)(e,t)}},function(e){return(0,h.bindActionCreators)({pressedCloseGuidebookScreen:Q.pressedCloseGuidebookScreen,fetchDetourData:Q.fetchDetourData},e)})(fe)},2120);