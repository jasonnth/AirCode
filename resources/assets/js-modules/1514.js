__d(function(e,t,a,i){Object.defineProperty(i,"__esModule",{value:!0});var r=t(790),l=t(412),n=babelHelpers.interopRequireDefault(l),o=t(271),s=(babelHelpers.interopRequireDefault(o),t(44)),u=t(654),c=t(759),d=babelHelpers.interopRequireDefault(c),p=t(379),h=babelHelpers.interopRequireDefault(p),f=t(1365),b=babelHelpers.interopRequireDefault(f),g=t(811),m=babelHelpers.interopRequireDefault(g),A=t(1369),S=babelHelpers.interopRequireDefault(A),y=t(410),_=babelHelpers.interopRequireDefault(y),I=t(927),D=babelHelpers.interopRequireDefault(I),P=t(1352),H=babelHelpers.interopRequireDefault(P),C=t(881),k=babelHelpers.interopRequireDefault(C),R=t(772),E=babelHelpers.interopRequireDefault(R),v=t(1443),x=t(1475),w=babelHelpers.interopRequireWildcard(x),L=t(1482),U=babelHelpers.interopRequireWildcard(L),T=t(1470),q=t(1487),F=babelHelpers.interopRequireDefault(q),O=t(1484),N=babelHelpers.interopRequireDefault(O),M=t(1472),W=t(1483),j=t(1515),V=babelHelpers.interopRequireDefault(j),B=t(1478),G={detail:F.default,microAuthDetail:N.default,actionName:n.default.string,userId:n.default.number,airlockId:n.default.number,uploadImageForChargebackAppeal:n.default.func,isFetching:n.default.bool,uploadImageSucceeded:n.default.bool,errorMessage:n.default.string,errorDetails:n.default.string},z={detail:null,microAuthDetail:null,actionName:null,userId:null,airlockId:null,uploadImageForChargebackAppeal:function(){},isFetching:!1,uploadImageSucceeded:!1,errorMessage:null,errorDetails:null},K=function(e){function t(a){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,e.call(this,a));return i.state={accessImageLibraryFailed:!1,imageUri:null,imageSource:null,isUploading:!1,nextDisabled:!0,showActionSheet:!1},i.uploadImage=i.uploadImage.bind(i),i.onPressVerifyAnotherWay=i.onPressVerifyAnotherWay.bind(i),i}return babelHelpers.inherits(t,e),t.prototype.onImagePicker=function(e){var t=this;e.then(function(e){var a=e.status,i=e.uri,r=e.data;a===S.default.StatusCodes.SUCCESS&&t.setState({showActionSheet:!1,imageUri:i,imageSource:r,nextDisabled:!1})}).catch(function(){return t.setState({accessImageLibraryFailed:!0,showActionSheet:!1})})},t.prototype.uploadImage=function(){var e=this.props,t=e.actionName,a=e.userId,i=e.airlockId,r=e.detail,l=r.payment_instrument_id,n=r.gibraltar_instrument_id,o=r.reservation_id,s=e.uploadImageForChargebackAppeal;(0,B.logPressContinue)(i,B.PAGE_NAMES.UPLOAD_CARD_STATEMENT_SCREEN),this.setState({isUploading:!0,nextDisabled:!0}),s({payment_instrument_id:l,gibraltar_instrument_id:n,reservation_id:o,file_type:"image/jpg",image_base64:this.state.imageSource,actionName:t,userId:a,airlockId:i}).then(function(e){e.success&&_.default.push(v.FILE_UPLOAD_SUCCESS)})},t.prototype.getActionSheetOptions=function(){var e=this,t={maxWidth:1024,maxHeight:1024},a=[{title:h.default.phrase("Take a photo",null,"Row text asking users to take a photo."),onPress:function(){return e.onImagePicker(S.default.launchCamera(a))}},{title:h.default.phrase("Choose an existing photo",null,"Row text asking users to choose an existing photo from device"),onPress:function(){return e.onImagePicker(S.default.launchImageLibrary(t))}},{title:h.default.phrase("Cancel",null,"Close this action sheet without doing anything."),onPress:function(){return e.setState({showActionSheet:!1})}}];return a},t.prototype.renderActionSheet=function(){if("android"===s.Platform.OS){var e=this.getActionSheetOptions();return babelHelpers.jsx(b.default,{title:h.default.phrase("Upload billing statement",null,"Title text in action sheet informing users to upload credit card statement."),options:e,cancelButtonIndex:e.length-1,svgIcon:D.default.SVGS.trust,visible:this.state.showActionSheet})}return null},t.prototype.openActionSheet=function(){if(this.setState({showActionSheet:!0}),"ios"===s.Platform.OS){var e=this.getActionSheetOptions();s.ActionSheetIOS.showActionSheetWithOptions({options:e.map(function(e){return e.title}),cancelButtonIndex:e.length-1},function(t){e[t].onPress()})}},t.prototype.onPressVerifyAnotherWay=function(){(0,B.logLaunchMicroAuth)(this.props.airlockId,B.PAGE_NAMES.UPLOAD_CARD_STATEMENT_SCREEN),_.default.push(v.MICRO_AUTHORIZATION_AMOUNTS_INPUT)},t.prototype.render=function(){var e=this;if(!this.props.detail)return null;var t=this.props.detail,a=t.cc_localized_name,i=t.cc_last_four,r=this.state,l=r.nextDisabled,n=r.isUploading,o=l?h.default.phrase("No statement added",null,"Status indicating that the user's billing statement has not been provided yet"):h.default.phrase("Statement added",null,"Status indicating that the user's billing statement has successfully been uploaded"),u=h.default.phrase("Adds a copy of your billing statement.",null,"Accessibility hint for a button that user should use to upload a billing statement for identity verification"),c=h.default.phrase("%{cc_localized_name} %{cc_last_four} billing statement",{cc_localized_name:a,cc_last_four:i},"Row title text informing users to upload credit card statement."),d=[c,o,u].join(", ");return babelHelpers.jsx(s.View,{style:s.StyleSheet.absoluteFill},void 0,babelHelpers.jsx(E.default,{title:h.default.phrase("Upload your billing statement",null,"Title text informing users to upload a image for their recent billing statement."),subtitle:h.default.phrase("Take a photo or screenshot of a recent billing statement. Make sure your full name and the last four digits of your account are visible.",null,"Informing users requirements of the billing statement we asked for."),subtitleLink:h.default.phrase("Learn how",null,"A link telling user how to upload card statement for verification."),onSubtitleLinkPress:function(){_.default.present(U.AUTHENTICATED_WEBVIEW,{url:(0,W.getWebUrl)("/help/article/1625/how-do-i-submit-my-credit-or-debit-card-billing-statement-for-payment-verification")})},footer:babelHelpers.jsx(k.default,{babu:!0,title:this.props.microAuthDetail&&h.default.phrase("Verify another way",null,"a button to verify credit card by micro authorization instead of chargeback appeal"),loading:n,buttonDisabled:l,buttonText:h.default.phrase("Submit",null,"Button text asking users to submit their uploaded statement."),onButtonPress:this.uploadImage,onSecondaryActionPress:this.onPressVerifyAnotherWay}),toasts:[babelHelpers.jsx(H.default,{id:M.CHARGEBACK_APPEAL_IMAGE_UPLOAD_FAILED,description:h.default.phrase("Something went wrong with the upload. Please try again later.",null,"an error message")},M.CHARGEBACK_APPEAL_IMAGE_UPLOAD_FAILED),this.state.accessImageLibraryFailed&&babelHelpers.jsx(H.default,{description:h.default.phrase("There was some error accessing your image library",null,"an error message for failling attempt to open native image library"),onClosePress:function(){return e.setState({accessImageLibraryFailed:!1})}},"accessImageLibraryFailed")]},void 0,babelHelpers.jsx(V.default,{imageSource:(0,m.default)(this.state.imageUri),title:c,accessibilityLabel:d,onPressImageUpload:function(){return e.openActionSheet()}})),this.renderActionSheet())},t}(o.PureComponent);K.propTypes=G,K.defaultProps=z,i.default=(0,r.connect)(function(e){return babelHelpers.extends({},(0,d.default)((0,T.chargebackAppealSelector)(e),["isFetching","uploadImageSucceeded","errorDetails","errorMessage"]),(0,d.default)((0,T.frictionManagerSelector)(e),["userId","actionName","airlockId"]),{detail:(0,T.chargebackAppealDetailSelector)(e),microAuthDetail:(0,T.microAuthorizationDetailSelector)(e)})},function(e){return(0,u.bindActionCreators)({uploadImageForChargebackAppeal:w.uploadImageForChargebackAppeal},e)})(K)},1514);