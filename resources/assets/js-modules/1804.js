__d(function(e,t,r,n){Object.defineProperty(n,"__esModule",{value:!0});var i=t(379),a=babelHelpers.interopRequireDefault(i),s=t(377),o=babelHelpers.interopRequireDefault(s),l=t(1372),p=babelHelpers.interopRequireDefault(l),u=t(412),d=babelHelpers.interopRequireDefault(u),c=t(271),f=(babelHelpers.interopRequireDefault(c),t(790)),b=t(44),h=t(893),I=babelHelpers.interopRequireDefault(h),T=t(773),m=babelHelpers.interopRequireDefault(T),v=t(410),y=babelHelpers.interopRequireDefault(v),g=t(1410),x=babelHelpers.interopRequireDefault(g),R=t(1382),E=babelHelpers.interopRequireDefault(R),H=t(1032),S=babelHelpers.interopRequireDefault(H),P=t(778),j=babelHelpers.interopRequireDefault(P),D=t(787),q=babelHelpers.interopRequireDefault(D),_=t(910),C=babelHelpers.interopRequireDefault(_),A=t(422),B=babelHelpers.interopRequireDefault(A),w=t(1352),k=babelHelpers.interopRequireDefault(w),N=t(789),L=babelHelpers.interopRequireDefault(N),O=t(1788),F=babelHelpers.interopRequireDefault(O),G=t(1805),V=babelHelpers.interopRequireDefault(G),M=t(1813),W=babelHelpers.interopRequireDefault(M),Y=t(1790),U=t(1795),z=t(1752),X=t(1796),Z=t(1818),J=t(1797),K=t(1798),Q=t(1770),$=babelHelpers.interopRequireWildcard(Q),ee=t(1803),te={loadTripInstance:d.default.func.isRequired,removeTripInstance:d.default.func.isRequired,experienceInstancesById:d.default.object.isRequired,experienceTemplatesById:d.default.object.isRequired,isSchedulerLoading:d.default.bool.isRequired,isTripInstanceLoading:d.default.bool.isRequired,payoutsByTripReservationId:d.default.object.isRequired,tripInstancesById:d.default.object.isRequired,tripTemplatesById:d.default.object.isRequired,tripInstanceIdFromEntryPoint:d.default.number.isRequired},re={},ne=function(e){var t=(0,ee.experienceInstancesSelector)(e),r=(0,ee.experienceTemplatesSelector)(e),n=(0,ee.payoutsSelector)(e),i=(0,ee.tripInstancesSelector)(e),a=(0,ee.tripTemplatesSelector)(e),s=(0,ee.availabilitySelector)(e);return{experienceInstancesById:t,experienceTemplatesById:r,isSchedulerLoading:s.isSchedulerLoading,isTripInstanceLoading:s.isTripInstanceLoading,payoutsByTripReservationId:n,tripInstancesById:i,tripTemplatesById:a}},ie={loadTripInstance:J.loadTripInstance,removeTripInstance:J.removeTripInstance},ae=function(e){function t(r){babelHelpers.classCallCheck(this,t);var n=babelHelpers.possibleConstructorReturn(this,e.call(this,r));return n.confirmRemove=n.confirmRemove.bind(n),n.loadTripInstance=n.loadTripInstance.bind(n),n.remove=n.remove.bind(n),n.viewPayouts=n.viewPayouts.bind(n),n.reviewGuests=n.reviewGuests.bind(n),n}return babelHelpers.inherits(t,e),t.prototype.componentDidMount=function(){if(!this.props.tripInstanceIdFromEntryPoint)return void y.default.pop();var e=this.getTripInstance();e&&e.detailsFetched||this.loadTripInstance()},t.prototype.loadTripInstance=function(){var e=this.props,t=e.isTripInstanceLoading,r=e.tripInstanceIdFromEntryPoint;t||this.props.loadTripInstance({id:r})},t.prototype.getTripInstance=function(){var e=this.props,t=e.tripInstanceIdFromEntryPoint;return e.tripInstancesById[t]},t.prototype.getTripTemplate=function(){var e=this.getTripInstance();return this.props.tripTemplatesById[e.associatedTripTemplateId]},t.prototype.viewExperienceInstance=function(e){var t=this.props,r=t.tripInstanceIdFromEntryPoint;t.isSchedulerLoading||y.default.push($.VIEW_EXPERIENCE_INSTANCE,{selectedExperienceInstanceId:e,selectedTripInstanceId:r})},t.prototype.viewPayouts=function(){var e=this,t=this.getTripInstance(),r=t.associatedTripReservationIds.map(function(t){return e.props.payoutsByTripReservationId[t]});y.default.push($.VIEW_TRIP_INSTANCE_PAYOUTS,{payouts:r})},t.prototype.reviewGuests=function(){var e=this.props.tripInstanceIdFromEntryPoint;y.default.push($.REVIEW_GUESTS_LIST,{selectedTripInstanceId:e})},t.prototype.remove=function(){var e=this.getTripInstance();(0,K.logEvent)("ViewTripInstance",{operation:"remove",trip_instance_id:e.id}),this.props.removeTripInstance({tripInstance:e}).then(function(e){e.success&&(y.default.pop(),y.default.push($.REMOVE_TRIP_INSTANCE_CONFIRMATION))})},t.prototype.confirmRemove=function(){var e=this;"ios"===b.Platform.OS?(0,X.openActionSheetWithOptions)([{title:a.default.phrase("Remove experience",null,"action sheet button for host to confirm removing trip instance"),onPress:function(){return e.remove()}},{title:a.default.phrase("Cancel",null,"button or link title for click to cancel an action")}],1,0):"android"===b.Platform.OS&&this.remove()},t.prototype.renderMarquee=function(){var e=this.getTripInstance(),t=this.getTripTemplate(),r=e.endsAt,n=e.guestsCount,i=e.startsAt,s=t.maxGuests,o=t.market,l=o.timezone,p=(0,z.getDescription)(t).name||a.default.phrase("(Noname)",null,"placeholder for empty experience title"),u=(0,U.formatDateRange)(i,r,l),d=a.default.phrase("%{bookedCount}/%{maxCount} guests booked",{bookedCount:n,maxCount:s},"describe the booked guests count and max guests count"),c=[u,d],f=c.join("\n");return babelHelpers.jsx(m.default,{title:p,subtitle:f})},t.prototype.renderSchedule=function(e){var t=this.props.isSchedulerLoading,r=this.getTripInstance(),n=this.getTripTemplate(),i=r.endsAt,s=r.startsAt,o=n.market.timezone,l=(0,U.getTimeWithZone)(s,o),u=l.format("ddd"),d=l.format(p.default.format("ss")),c=u+" \n"+d,f=(0,U.getTimeWithZone)(i,o),h=f.format("ddd"),I=f.format(p.default.format("ss")),T=h+" \n"+I;return babelHelpers.jsx(j.default,{divider:"padded"},void 0,e?null:babelHelpers.jsx(b.View,{},void 0,babelHelpers.jsx(C.default,{heavy:!0,first:!0,title:a.default.phrase("Schedule",null,"section header for trip instance schedule details and actions")}),babelHelpers.jsx(E.default,{start:c,end:T})),!(0,z.isPastTripInstance)(r)&&babelHelpers.jsx(S.default,{icon:null,isLoading:t,title:a.default.phrase("Remove from calendar",null,"action title for the link to remove trip instance from calendar"),onPress:this.confirmRemove}))},t.prototype.renderGroupChatButton=function(){var e=this.getTripInstance(),t=e.associatedThreadId;return t?babelHelpers.jsx(I.default,{divider:"none"},void 0,babelHelpers.jsx(I.default.Button,{icon:"comments",label:a.default.phrase("Group chat",null,"button caption for the button to open group chat"),onPress:function(){return(0,X.openTripHostThreadDeepLink)(t)}})):null},t.prototype.renderItinerary=function(){var e=this,t=this.props,r=t.experienceInstancesById,n=t.experienceTemplatesById,i=this.getTripInstance(),s=this.getTripTemplate(),o=i.associatedExperienceInstanceIds,l=s.market.timezone;return babelHelpers.jsx(j.default,{divider:"padded"},void 0,babelHelpers.jsx(C.default,{heavy:!0,first:!0,title:a.default.phrase("Itinerary",null,"section header for trip itinerary showing list of experiences")}),o.map(function(t,i){var s=r[t],o=n[s.associatedExperienceTemplateId],p=s.startsAt,u=o.durationHours,d=(0,z.getDescription)(o).name||a.default.phrase("(Noname)",null,"placeholder for empty experience title"),c=(0,z.getExperienceTemplatePhoto)(o),f=(0,U.getEndsAt)(p,u),b=(0,U.formatDateTimeRange)(p,f,l);return babelHelpers.jsx(x.default,{title:d,subtitle:b,image:c,imageShape:"cover",onPress:function(){return e.viewExperienceInstance(t)}},i)}))},t.prototype.renderSingleExperienceDetails=function(){var e=this.props,t=e.tripInstanceIdFromEntryPoint,r=e.experienceInstancesById,n=e.experienceTemplatesById,i=this.getTripInstance(),a=this.getTripTemplate(),s=i.associatedExperienceInstanceIds;if(s.length<=0)return null;var o=s[0],l=r[o],p=l.associatedExperienceTemplateId,u=n[p];return babelHelpers.jsx(W.default,{tripTemplate:a,experienceInstance:l,experienceTemplate:u,selectedTripInstanceId:t})},t.prototype.renderGuests=function(){var e=this.getTripInstance(),t=this.getTripTemplate();return babelHelpers.jsx(V.default,{tripInstance:e,tripTemplate:t})},t.prototype.renderExperienceDetails=function(){var e=this.getTripInstance(),t=this.getTripTemplate(),r=e.totalNativePayout,n=t.market,i=r?o.default.priceString(r.amount,r.currency):"0",s=(0,z.isPastTripInstance)(e),l=!s&&!!n&&!!n.phone;return babelHelpers.jsx(b.View,{},void 0,babelHelpers.jsx(j.default,{},void 0,babelHelpers.jsx(C.default,{heavy:!0,first:!0,title:a.default.phrase("Experience details",null,"section header for showing booking details of the trip instance")}),babelHelpers.jsx(S.default,{title:a.default.phrase("Total payout",null,"row title for showing total payout currency and amout of the trip instance"),actionTitle:i,onPress:this.viewPayouts}),l&&babelHelpers.jsx(S.default,{icon:null,title:a.default.phrase("Cancel experience",null,"action title for host to click and cancel a booked trip instance"),onPress:function(){return y.default.present($.REMOVE_TRIP_INSTANCE_CONTACT_AIRBNB,{phone:n.phone})}})),babelHelpers.jsx(b.View,{style:se.bottomSpacer}))},t.prototype.render=function(){var e=this.props.isTripInstanceLoading,t=this.getTripInstance();if(!t)return babelHelpers.jsx(b.View,{style:se.loadingContainer},void 0,babelHelpers.jsx(y.default.Screen,{barType:y.default.Screen.BAR_TYPE.SPECIALTY,hideStatusBarUntilFoldOffset:!0}),babelHelpers.jsx(F.default,{}));var r=this.getTripTemplate(),n=r.productType===Z.EXPERIENCE_TYPE_SINGLE_DAY,i=e||!t.detailsFetched,s=(0,z.isBookedTripInstance)(t);return babelHelpers.jsx(b.View,{style:se.container},void 0,babelHelpers.jsx(y.default.Screen,{barType:y.default.Screen.BAR_TYPE.SPECIALTY,hideStatusBarUntilFoldOffset:!0}),babelHelpers.jsx(q.default,{},void 0,this.renderMarquee(),!s&&this.renderSchedule(n),s&&!i&&this.renderGroupChatButton(),!n&&this.renderItinerary(),n&&!i&&this.renderSingleExperienceDetails(),!s&&this.renderGuests(),s&&i&&babelHelpers.jsx(F.default,{}),s&&!i&&this.renderGuests(),s&&!i&&this.renderExperienceDetails()),babelHelpers.jsx(L.default,{},void 0,babelHelpers.jsx(k.default,{id:Y.LOAD_TRIP_INSTANCE_FAILED_TOAST,description:a.default.phrase("Something went wrong when loading your experience",null,"text to tell user it fails to load trip instance"),action:a.default.phrase("Try again",null,"link title for click to retry"),onActionPress:this.loadTripInstance}),babelHelpers.jsx(k.default,{id:Y.REMOVE_TRIP_INSTANCE_FAILED_TOAST,description:a.default.phrase("Something went wrong when removing this experience",null,"text to tell user it fails to remove trip instance"),action:a.default.phrase("Try again",null,"link title for click to retry"),onActionPress:this.remove})))},t}(c.Component);ae.propTypes=te,ae.defaultProps=re;var se=B.default.create(function(e){var t=e.bp;return{container:{flex:1,backgroundColor:e.color.white},bottomSpacer:{paddingBottom:2*t},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center"}}});n.default=(0,f.connect)(ne,ie)(ae)},1804);