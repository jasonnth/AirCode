__d(function(e,t,a,i){function r(e,t){R.default.push(Ee.SHARING,{entry_point:"guidebook_place",id:e.primary_place.id,url:e.share_url||(0,V.getWebUrl)("/things-to-do/place/"+e.primary_place.id),primary_image_url:t,location:e.dim_market,place_name:e.primary_place_name,place_type:e.primary_place.category_for_display})}Object.defineProperty(i,"__esModule",{value:!0});var l=t(412),o=babelHelpers.interopRequireDefault(l),n=t(271),s=babelHelpers.interopRequireDefault(n),u=t(44),d=t(42),p=babelHelpers.interopRequireDefault(d),c=t(654),f=t(790),b=t(379),h=babelHelpers.interopRequireDefault(b),m=t(787),P=babelHelpers.interopRequireDefault(m),g=t(1032),_=babelHelpers.interopRequireDefault(g),k=t(2080),y=babelHelpers.interopRequireDefault(k),E=t(778),S=babelHelpers.interopRequireDefault(E),H=t(410),R=babelHelpers.interopRequireDefault(H),v=t(910),D=babelHelpers.interopRequireDefault(v),C=t(841),I=babelHelpers.interopRequireDefault(C),T=t(1023),M=t(1388),j=babelHelpers.interopRequireDefault(M),x=t(1435),A=babelHelpers.interopRequireDefault(x),q=t(1398),w=babelHelpers.interopRequireDefault(q),L=t(1038),O=babelHelpers.interopRequireDefault(L),N=t(2004),U=babelHelpers.interopRequireDefault(N),G=t(2081),W=babelHelpers.interopRequireDefault(G),J=t(562),F=babelHelpers.interopRequireDefault(J),Y=t(2073),B=babelHelpers.interopRequireDefault(Y),V=t(1483),z=t(2035),K=t(713),Q=babelHelpers.interopRequireDefault(K),X=t(2056),Z=t(2084),$=babelHelpers.interopRequireDefault(Z),ee=t(2046),te=t(2054),ae=babelHelpers.interopRequireDefault(te),ie=t(2085),re=babelHelpers.interopRequireDefault(ie),le=t(2030),oe=babelHelpers.interopRequireWildcard(le),ne=t(2088),se=t(2089),ue=babelHelpers.interopRequireDefault(se),de=t(2031),pe=babelHelpers.interopRequireWildcard(de),ce=t(714),fe=babelHelpers.interopRequireDefault(ce),be=t(2090),he=babelHelpers.interopRequireDefault(be),me=t(705),Pe=babelHelpers.interopRequireDefault(me),ge=t(2093),_e=t(1920),ke=babelHelpers.interopRequireWildcard(_e),ye=t(1482),Ee=babelHelpers.interopRequireWildcard(ye),Se=function(){return new Promise(function(){})},He=p.default.module({moduleName:"ActivityAddToPlansBridge",isEventEmitter:!1,mock:{presentAddToPlansFlowForPlaceId:Se}}),Re={itineraryMinDate:o.default.string,itineraryMaxDate:o.default.string,itineraryTimeSelectOnly:o.default.bool,fetchPDP:o.default.func.isRequired,fetchMeetup:o.default.func.isRequired,joinPlaceMeetup:o.default.func.isRequired,unjoinPlaceMeetup:o.default.func.isRequired,createScheduledPlace:o.default.func.isRequired,pressedCloseGuidebookScreen:o.default.func.isRequired,meetup:o.default.object,place:o.default.object,placeMeta:o.default.object,title:o.default.string,placePhotos:o.default.array,placeId:B.default.isRequired,meetupId:o.default.number,primaryPhoto:o.default.string,guidebookId:o.default.number,tripScheduleConfirmationCode:o.default.string,placePdpType:o.default.number,searchContextString:o.default.string},ve={itineraryTimeSelectOnly:!1,placePdpType:ge.PlacePdpTypeEnums.GENERAL},De=function(e){function t(a){babelHelpers.classCallCheck(this,t);var i=babelHelpers.possibleConstructorReturn(this,e.call(this,a));return i.datePickerRef=i.datePickerRef.bind(i),i.onPressHeart=i.onPressHeart.bind(i),i.onSuggestEdit=i.onSuggestEdit.bind(i),i.handleMomentumScrollEnd=i.handleMomentumScrollEnd.bind(i),i.state={additionalPhoneRowProps:{},isWishListed:!1},i.prevY=0,i}return babelHelpers.inherits(t,e),t.prototype.componentWillMount=function(){var e=this;this.props.fetchPDP(this.props.placeId,this.props.guidebookId).then(function(){if(e.props.place&&e.props.place.primary_place){var t=e.props.place.primary_place,a=t.phone&&t.phone.replace(/\D/g,""),i=e.props.placePdpType;if(a){var r="tel:"+a;u.Linking.canOpenURL(r).then(function(l){l?e.setState({additionalPhoneRowProps:{actionTitle:h.default.phrase("Call",null,"button that calls the adjacently displayed phone number"),onPress:function(){u.Alert.alert(h.default.phrase("Call %{phone_number}?",{phone_number:t.phone},"a text asking users to confirm they want to make a phone call"),null,[{text:h.default.phrase("Cancel",null,"a button to click when users want to cancel the phone call")},{text:h.default.phrase("Confirm",null,"a button to click when users want to make a phone call"),onPress:function(){u.Linking.openURL(r),(0,ge.logGuidebookClickPlacePdpInfoSectionEvent)(t.id,"Phone",i)}}])}}}):e.setState({additionalPhoneRowProps:{actionTitle:h.default.phrase("Copy",null,"button that copies the adjacently displayed phone number"),onPress:function(){u.Clipboard.setString(a),(0,ge.logGuidebookClickPlacePdpInfoSectionEvent)(t.id,"Phone",i)}}})})}}}),this.props.fetchMeetup(this.props.placeId,this.props.meetupId)},t.prototype.componentDidMount=function(){var e=this;this.subscription=fe.default.subscribeIsWishlisted(fe.default.TYPE.PLACE,this.props.placeId,function(t){return e.setState({isWishListed:t})}),this.props.meetupId?(0,ge.logMeetupPDPImpressionEvent)(this.props.meetupId,this.props.searchContextString):(0,ge.logPlacePDPImpressionEvent)(Number(this.props.placeId),this.props.searchContextString)},t.prototype.componentWillUnmount=function(){fe.default.unsubscribe(this.subscription)},t.prototype.onPressHeart=function(){fe.default.togglePlaceWishListed(this.props.placeId,fe.default.SOURCE.PLACE_SCREEN)},t.prototype.onSuggestEdit=function(){var e=h.default.phrase("Have any feedback?",null,"Feedback page for guidebooks title"),t=h.default.phrase("Suggest an edit or report an issue with this location.",null,"Feedback page for guidebooks subtitle");R.default.push(ke.FEEDBACK,{eventName:"guidebook_feedback_native",eventData:{place_id:this.props.placeId},title:e,subtitle:t})},t.prototype.datePickerRef=function(e){this.datePicker=e},t.prototype.handleMomentumScrollEnd=function(e){var t=e.nativeEvent.contentOffset.y,a=t<this.prevY;this.prevY=t,(0,ge.logGuidebookScrollPlacePdpEvent)(parseInt(this.props.placeId,10),a,this.props.placePdpType)},t.prototype.addToPlans=function(e){var t,a,i,r,l,o;return regeneratorRuntime.async(function(n){for(;;)switch(n.prev=n.next){case 0:return t=this.props,a=t.placeId,i=t.place,r=t.tripScheduleConfirmationCode,n.prev=1,n.next=4,regeneratorRuntime.awrap(He.presentAddToPlansFlowForPlaceId(String(a)));case 4:if(l=n.sent,o=l[0]){n.next=8;break}return n.abrupt("return");case 8:o.shouldOpenDirections?Q.default.showMap((0,X.getAddressString)(i.primary_place)):o.shouldOpenDatePicker?this.datePicker.onPressDate():o.date&&this.props.createScheduledPlace(i,(0,F.default)(o.date,e),r),n.next=13;break;case 11:n.prev=11,n.t0=n.catch(1);case 13:case"end":return n.stop()}},null,this,[[1,11]])},t.prototype.render=function(){var e=this,t=this.props,a=t.itineraryTimeSelectOnly,i=t.itineraryMinDate,l=t.itineraryMaxDate,o=t.meetup,n=t.place,d=t.placeMeta,p=t.title,c=t.placeId,f=t.guidebookId,b=t.tripScheduleConfirmationCode,m=t.placePhotos,g=t.placePdpType,k=this.state,E=k.additionalPhoneRowProps,H=k.isWishListed,v=void 0,C=void 0,T=void 0,M=void 0,x=void 0,q=void 0,L=void 0,N=void 0,G=void 0,J=void 0,Y=!1,B=!1,V=void 0,z=void 0,K=void 0;n&&(T=d&&d.scheduledPlaceStatus,v=n.primary_place,C=n.photos.slice(0,4).map(function(e){return e.picture}),M=n.primary_place_name,x=n.localized_singular_sub_category_name,q=n.localized_neighborhood_name,V=n.dim_market,K=v&&v.recommendation_items,L=q?!!x&&h.default.phrase("%{subcategory} in %{neighborhood}",{subcategory:x,neighborhood:q},"subtitle, e.g. restaurant in mission"):x,N=n.ranked_place_recommendations_for_place_view.filter(function(e){return e.user&&e.user.thumbnail_url}),G=N.slice(0,1),G&&G[0]&&(Y=G[0].guidebook_id),J=new Set(n.place_recommendation_ids).size,Y&&(J-=1),B=J>1,z=v&&(0,X.getStreetComponentsString)(v));var Z="YYYY-MM-DD HH:mm",ee=i?(0,F.default)(i):(0,F.default)(),te=i?ee.clone():ee.clone().add(1,"hour").startOf("hour"),ie=l?(0,F.default)(l):ee.clone().add(365,"days"),le=a?"time":"datetime",se=o?h.default.phrase("What Airbnb hosts say about this place",null,"alternate title for recommendations or tips from Airbnb local host"):h.default.phrase("What Airbnb hosts say",null,"title for recommendations or tips from Airbnb local host"),de=!(!v||o||T===oe.CREATE_SCHEDULED_PLACE_SUCCEEDED);return babelHelpers.jsx(ae.default,{},void 0,babelHelpers.jsx(P.default,{withInsets:[de&&y.default],onMomentumScrollEnd:this.handleMomentumScrollEnd},void 0,babelHelpers.jsx(A.default,{title:M||p,subtitle:L,subtitleWillBeProvided:!0,images:m||C||[],barType:R.default.BAR_TYPE.SPECIALTY,hideStatusBarUntilFoldOffset:!0,onPressImage:function(e){return R.default.push(ke.PHOTO_CAROUSEL,{placeId:c,index:e,guidebookId:f})},onBackPress:this.props.pressedCloseGuidebookScreen},void 0,(0,ne.shouldShowGuidebooksShareSheet)()&&n&&C&&C[0]&&babelHelpers.jsx(O.default,{icon:"share",onPress:function(){return r(n,C[0])}}),babelHelpers.jsx(O.default,{icon:H?"heart":"heart-alt",onPress:this.onPressHeart})),!v&&babelHelpers.jsx(u.View,{style:Ce.loaderContainer},void 0,babelHelpers.jsx(I.default,{})),o&&babelHelpers.jsx(ue.default,{startTime:o.starts_at,endTime:o.ends_at,title:o.title,description:o.message||"",peopleCount:o.guest_count||0,onJoinPress:function(){if(o.status!==pe.JOIN_PLACE_MEETUP_STARTED&&o.status!==pe.UNJOIN_PLACE_MEETUP_STARTED){if(o.joined)return(0,ge.logGuidebookClickPlacePdpMeetupJoinEvent)(c,"UNJOIN",g),void e.props.unjoinPlaceMeetup(c,o.place_reservation_id,V);(0,ge.logGuidebookClickPlacePdpMeetupJoinEvent)(c,"JOIN",g),e.props.joinPlaceMeetup(c,o.id,V)}},isJoined:!!o.joined,loading:o.status===pe.JOIN_PLACE_MEETUP_STARTED||o.status===pe.UNJOIN_PLACE_MEETUP_STARTED}),n&&G.map(function(e){return e.guidebook_id?babelHelpers.jsx(u.View,{},e.guidebook_id,babelHelpers.jsx(D.default,{title:h.default.phrase("FEATURED IN",null,"title for recommendations or tips from guidebook insider for a place"),first:!0,kicker:!0}),babelHelpers.jsx(re.default,{guidebookId:e.guidebook_id,placeId:c,insiderRecommendation:e},e.id)):babelHelpers.jsx(u.View,{},e.guidebook_id,babelHelpers.jsx(D.default,{title:se,first:!0,micro:!0,heavy:!0}),babelHelpers.jsx(U.default,{description:e.description,userName:"",title:h.default.phrase("From %{firstName}",{firstName:e.user.first_name},"title for guidebook from home host, e.g. from Jenny"),image:e.user.thumbnail_url,extraMarginBottom:!0},e.id))}),n&&B&&babelHelpers.jsx(j.default,{title:h.default.phrase("Tips from %{recommendations} hosts",{recommendations:J},"total count of local recommendations for a place"),onPress:function(){return R.default.push(ke.RECOMMENDATIONS,{placeId:c,guidebookId:f,placePdpType:g})}}),n&&n.coordinate&&babelHelpers.jsx($.default,{airmoji:n.airmoji,coordinate:n.coordinate}),babelHelpers.jsx(S.default,{},void 0,v&&!!z&&babelHelpers.jsx(_.default,{subtitle:z,actionTitle:h.default.phrase("Directions",null,"button that opens an app that gives directions to a place"),title:h.default.phrase("Address",null,"title for business address"),onPress:function(){(0,ge.logGuidebookClickPlacePdpInfoSectionEvent)(n.primary_place.id,"Address",g),Q.default.showMap((0,X.getAddressString)(v))}}),v&&v.opening_hours&&v.opening_hours.length>0&&babelHelpers.jsx(w.default,{hours:v.opening_hours,onPress:function(){return(0,ge.logGuidebookClickPlacePdpInfoSectionEvent)(n.primary_place.id,"Hours",g)}}),v&&!!v.phone&&s.default.createElement(_.default,babelHelpers.extends({title:h.default.phrase("Phone number",null,"title for the business phone number"),subtitle:v.phone},E)),v&&!!v.website&&babelHelpers.jsx(_.default,{title:h.default.phrase("Website",null,"title for the business website"),subtitle:(0,X.getShortWebAddress)(v),actionTitle:h.default.phrase("View",null,"button that performs an action related to the adjacent content"),onPress:function(){(0,ge.logGuidebookClickPlacePdpInfoSectionEvent)(n.primary_place.id,"Website",g),u.Linking.openURL(v.website)}}),n&&!!n.suggested_edit_url&&babelHelpers.jsx(_.default,{title:h.default.phrase("Report an issue",null,"title for the suggest an edit to place data"),onPress:function(){(0,ge.logGuidebookClickPlacePdpInfoSectionEvent)(n.primary_place.id,"Suggestion",g),e.onSuggestEdit()}})),K&&K.items&&!!K.items.length&&Pe.default.launch("rn.places.place_recommended_items")&&babelHelpers.jsx(he.default,{recommendationItemsSection:K})),de&&babelHelpers.jsx(y.default,{onPress:function(){(0,ge.logGuidebookClickPlacePdpAddItineraryEvent)(v.id,g),Pe.default.launch("rn.places.enable_add_to_plans")?e.addToPlans(Z):e.datePicker.onPressDate()},loading:T===oe.CREATE_SCHEDULED_PLACE_STARTED},void 0,h.default.phrase("Add to itinerary",null,"a button that opens a date/time picker")),v&&s.default.createElement(W.default,{ref:this.datePickerRef,style:Ce.hidden,date:te.format(Z),mode:le,format:Z,minDate:ee.format(Z),maxDate:ie.format(Z),confirmBtnText:h.default.phrase("Confirm",null,"a button to confirm date/time to add to itinerary"),cancelBtnText:h.default.phrase("Cancel",null,"a button to cancel date/time selection for itinerary"),onDateChange:function(t){e.props.createScheduledPlace(n,(0,F.default)(t,Z),b),(0,ge.logGuidebookClickPlacePdpAddItineraryConfirmEvent)(v.id,g)},showIcon:!1}))},t}(s.default.PureComponent);De.defaultProps=ve,De.propTypes=Re;var Ce=T.ThemedStyleSheet.create(function(e){var t=e.size;return{hidden:{width:0,height:0},itinerary:{paddingVertical:t.vertical.medium},loaderContainer:{paddingVertical:t.vertical.medium}}});i.default=(0,f.connect)(function(e,t){return{place:(0,ee.guidebookPlaceSelector)(e,t),meetup:(0,ee.guidebookPlaceMeetupSelector)(e,t),placeMeta:(0,ee.guidebookPlaceMetaSelector)(e,t)}},function(e){return(0,c.bindActionCreators)({fetchPDP:z.fetchPDP,fetchMeetup:z.fetchMeetup,joinPlaceMeetup:z.joinPlaceMeetup,unjoinPlaceMeetup:z.unjoinPlaceMeetup,createScheduledPlace:z.createScheduledPlace,pressedCloseGuidebookScreen:z.pressedCloseGuidebookScreen},e)})(De)},2079);