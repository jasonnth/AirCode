__d(function(e,t,i,n){Object.defineProperty(n,"__esModule",{value:!0});var o=t(412),s=babelHelpers.interopRequireDefault(o),r=t(271),l=babelHelpers.interopRequireDefault(r),a=t(44),T=t(1023),u=t(1037),h=babelHelpers.interopRequireDefault(u),d=t(841),c=babelHelpers.interopRequireDefault(d),p=t(1593),O=babelHelpers.interopRequireDefault(p),f=t(1595),_=babelHelpers.interopRequireDefault(f),b=t(1594),H=babelHelpers.interopRequireDefault(b),I=t(709),g=babelHelpers.interopRequireDefault(I),E=t(713),N=babelHelpers.interopRequireDefault(E),A=t(1589),S=t(1588),m=t(1596),C=babelHelpers.interopRequireDefault(m),D=t(1597),R=babelHelpers.interopRequireDefault(D),x=t(1598),M=babelHelpers.interopRequireDefault(x),v=T.ThemedStyleSheet.create(function(e){var t=e.size;return{container:{flex:1},textContainer:{left:0,right:0,paddingHorizontal:t.horizontal.medium,marginTop:t.vertical.small,position:"absolute",alignItems:"flex-start",top:0,flex:1},buttonContainer:{left:0,right:0,flex:1,position:"absolute",alignItems:"flex-end"},buttonContainerFullSizePadding:{bottom:A.HERO_BUTTON_CONTAINER_PADDING_BOTTOM},buttonContainerMiniSizePadding:{bottom:A.HERO_BUTTON_CONTAINER_PADDING_BOTTOM_MINI},loadingContainer:{paddingHorizontal:t.horizontal.medium}}}),P={contentOffsetY:s.default.number,flowType:s.default.oneOf(S.FLOW_TYPES),heroMessage:C.default},B={contentOffsetY:0},y=function(e){function t(i,n){babelHelpers.classCallCheck(this,t);var o=babelHelpers.possibleConstructorReturn(this,e.call(this,i,n));return o.onTextAnimationFinish=o.onTextAnimationFinish.bind(o),o.state={isTextAnimationFinished:!1,isLoadingAction:!1,heroMessage:i.heroMessage,heroActions:i.heroMessage.heroActions},o.scrollToBottom=o.scrollToBottom.bind(o),o.onContentSizeChange=o.onContentSizeChange.bind(o),o.onHeroActionClick=o.onHeroActionClick.bind(o),o.handleDestination=o.handleDestination.bind(o),o.dismissIfTakeOver=o.dismissIfTakeOver.bind(o),o.shouldShowFullSize=o.shouldShowFullSize.bind(o),o.scrollView=null,o.heroTextContentHeight=0,o.textContainerHeight=0,o.setScrollView=o.setScrollView.bind(o),o}return babelHelpers.inherits(t,e),t.prototype.onTextAnimationFinish=function(){this.setState({isTextAnimationFinished:!0})},t.prototype.onHeroActionClick=function(e,t){this.props.flowType===S.HERO_TAKEOVER&&g.default.clickedHeroActionWithMessageID(e),this.handleDestination(t)},t.prototype.handleDestination=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.destination;switch(t.destinationType){case S.DESTINATION_TYPE_LOCATION:this.dismissIfTakeOver(),N.default.showMap(i);break;case S.DESTINATION_TYPE_URL:this.dismissIfTakeOver(),a.Linking.openURL(i);break;case S.DESTINATION_TYPE_CALLBACK:this.dismissIfTakeOver(),i();break;case S.DESTINATION_TYPE_POST:null!==t.heroActionId&&(this.setState({isLoadingAction:!0}),(0,R.default)(t.heroActionId).then(function(t){e.setState({isLoadingAction:!1});var i=t;i.destinationType=t.destination_type,i.destination=t.destination,i.heroMessage=(0,M.default)(t.next_message),e.handleDestination(i)}));break;case S.DESTINATION_TYPE_DISMISS:this.dismissIfTakeOver();break;case S.DESTINATION_TYPE_HERO:this.setState({heroMessage:t.heroMessage,heroActions:t.heroMessage.heroActions,isTextAnimationFinished:!1})}},t.prototype.dismissIfTakeOver=function(){this.props.flowType===S.HERO_TAKEOVER&&g.default.dismissHeroMessage()},t.prototype.setScrollView=function(e){this.scrollView=e},t.prototype.scrollToBottom=function(){var e=this.heroTextContentHeight+A.HERO_LOADING_CONTAINER_HEIGHT,t=e-this.textContainerHeight;t>0&&this.scrollView.scrollTo({y:t})},t.prototype.shouldShowFullSize=function(){return this.state.heroMessage.fullSize||"android"===a.Platform.OS},t.componentHeight=function(e){var t=void 0;return t=e?a.Dimensions.get("window").height-A.HERO_COMPONENT_MARGIN_BOTTOM:A.COMPONENT_HEIGHT_MINI,t},t.calculateTextContainerHeight=function(e,i){return i?t.componentHeight(i)-(e+A.HERO_BUTTON_CONTAINER_PADDING_BOTTOM):t.componentHeight(i)-(e+A.HERO_BUTTON_CONTAINER_PADDING_BOTTOM_MINI)},t.calculateButtonContainerHeight=function(e,t){var i=void 0,n=void 0;return t?(i=A.HERO_BUTTON_HEIGHT+A.HERO_BUTTON_PADDING_BOTTOM,n=i*e+A.HERO_BUTTON_CONTAINER_PADDING_BOTTOM):(i=A.HERO_BUTTON_HEIGHT_MINI+A.HERO_BUTTON_PADDING_BOTTOM,n=i*e),n},t.prototype.onContentSizeChange=function(e,t){this.heroTextContentHeight=t,this.scrollToBottom()},t.prototype.renderTextList=function(e){var t=this.props.contentOffsetY,i=this.state.heroMessage.messages,n=this.shouldShowFullSize();this.textContainerHeight=e;var o=void 0,s=void 0,r=void 0;n?(o=A.HERO_TEXT_TOP_OFFSET,s=A.HERO_TYPING_ANIMATION_DELAY,r=A.HERO_TYPING_SPEED):(o=A.HERO_TEXT_TOP_OFFSET_MINI,s=A.HERO_TYPING_ANIMATION_DELAY_MINI,r=A.HERO_TYPING_SPEED_MINI);var T=o+t,u={bottom:A.HERO_TEXT_BOTTOM_INSET};return babelHelpers.jsx(a.View,{style:[v.textContainer,{height:e}]},void 0,l.default.createElement(a.ScrollView,{style:[{height:e-T,marginTop:T,marginBottom:A.HERO_TEXT_BOTTOM_INSET}],showsVerticalScrollIndicator:!1,onContentSizeChange:this.onContentSizeChange,ref:this.setScrollView,contentInset:u},babelHelpers.jsx(O.default,{onComplete:this.onTextAnimationFinish,fullSize:n},i,i&&i.filter(function(e){return null!==e}).map(function(e,t){return babelHelpers.jsx(_.default,{delay:0===t?0:s,textTypingDuration:r*e.length},t,e)}))))},t.prototype.renderButtonList=function(e){var t=this,i=this.state.heroMessage,n=i.messageID,o=i.dismissText,s=this.state.heroActions,r=this.shouldShowFullSize();return this.state.isTextAnimationFinished?babelHelpers.jsx(a.View,{style:[v.buttonContainer,{height:e},r?v.buttonContainerFullSizePadding:v.buttonContainerMiniSizePadding]},void 0,this.state.isLoadingAction&&babelHelpers.jsx(a.View,{style:[v.loadingContainer]},void 0,babelHelpers.jsx(c.default,{light:!0})),!this.state.isLoadingAction&&babelHelpers.jsx(O.default,{fullSize:r},"buttons",s.filter(function(e){return e.text}).map(function(e,i){return babelHelpers.jsx(H.default,{},i,babelHelpers.jsx(h.default,{sizeToFit:!r,small:!r,onPress:function(){return t.onHeroActionClick(n,e)}},void 0,e.text))}),o&&babelHelpers.jsx(O.default.View,{fullSize:r},void 0,babelHelpers.jsx(h.default,{sizeToFit:!r,small:!r,onPress:function(){return g.default.dismissHeroMessage()}},void 0,o)))):null},t.prototype.render=function(){var e=this.state.heroMessage,i=e.dismissText,n=e.heroActions,o=n?n.length:0,s=i?o+1:o,r=this.shouldShowFullSize(),l=t.calculateButtonContainerHeight(s,r),T=t.calculateTextContainerHeight(l,r);return babelHelpers.jsx(a.View,{style:v.container},void 0,this.renderTextList(T),this.renderButtonList(l))},t}(r.Component);y.defaultProps=B,y.propTypes=P,n.default=y},1592);