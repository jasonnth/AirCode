__d(function(e,t,a,r){function n(){return new T.Participant({id:m.TRIP_SUPPORT_BOT_ID,data:{name:h.default.phrase("Airbnb Help",null,"Airbnb help provides chat experience to help users solve issues by themself."),image:m.TRIP_SUPPORT_AVATAR}})}function i(e){var t=e.image;return new T.Participant({id:m.TRIP_SUPPORT_VIEWER_ID,data:{name:"PLACEHOLDER",image:t}})}function s(e,t){switch(t.display_type){case m.DISPLAY_TYPE.MESSAGE:return{type:I.TRIP_SUPPORT_MARKDOWN,data:{content:t.message}};case m.DISPLAY_TYPE.LINK_AND_DIALOG:return{type:I.TRIP_SUPPORT_LINK_AND_DIALOG,data:{content:t.dialog_content,label:t.link_label,isMarkdown:!0}};case m.DISPLAY_TYPE.MAP:return{type:I.TRIP_SUPPORT_MAP,data:{imageUrl:t.map_image_url,mapUrl:t.map_url}};default:return{type:I.TRIP_SUPPORT_MARKDOWN,data:{content:h.default.phrase("Unsupported message type. Please upgrade your Airbnb App or [go to website](http://www.airbnb.com/inbox/help/%{threadID}).",{threadID:e},"If a message that can not be displayed correctly on mobile, show this message to guide user download the latest app or go website.")}}}}function o(e,t,a,r){var i=[];return t.forEach(function(e){e.merge&&i.length>0?i[i.length-1].push(e):i.push([e])}),i.map(function(t,i){var o=null;return o=1===t.length?s(e,t[0]):{type:I.TRIP_SUPPORT_MESSAGE_BLOCK,data:{items:t.map(function(t){return s(e,t)})}},new T.Item(babelHelpers.extends({id:"message-"+a+"-"+t[0].id,sender:n(),senderID:m.TRIP_SUPPORT_BOT_ID,sendStatus:T.SEND_STATUS.SENT,timestamp:r+i+1,threadID:e},o))})}function l(e,t,a,r,n,s,o,l){return new T.Item({id:"helpOptions_"+a,sender:i({image:o.has_profile_pic?o.thumbnail_url:null}),senderID:m.TRIP_SUPPORT_VIEWER_ID,sendStatus:T.SEND_STATUS.SENT,type:I.TRIP_SUPPORT_HELP_OPTIONS,data:{options:r.map(function(e){return{value:e.value,text:e.label,onClick:e.on_click}}),issueId:t,nodeId:a,selectedOption:n,isCurrent:s},timestamp:l,threadID:e})}function p(e,t,a,r,n){var s=a.filter(function(e){return e.type.startsWith("image")});return new T.Item({id:"helpOptions_"+t,sender:i({image:r.has_profile_pic?r.thumbnail_url:null}),senderID:m.TRIP_SUPPORT_VIEWER_ID,sendStatus:T.SEND_STATUS.SENT,type:I.TRIP_SUPPORT_ATTACHMENTS,data:{photos:s},timestamp:n,threadID:e})}function u(e,t,a,r){var n=[];if(!0===t.is_invisible_node)return n;var i=Date.parse(t.created_at),s=Date.parse(t.updated_at);return s===i&&(s+=100),n.push.apply(n,babelHelpers.toConsumableArray(o(a.id,t.things_to_display,t.id,i))),t.help_options&&t.help_options.length>0&&(c(t)&&r?n.push(p(a.id,t.id,r,a.speaker,s)):n.push(l(a.id,e.id,t.id,t.help_options,t.selected_option,t.is_current,a.speaker,s))),n}function _(e,t,a){for(var r=[],n=e.nodes,i=Array.isArray(n),s=0,n=i?n:n["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var o;if(i){if(s>=n.length)break;o=n[s++]}else{if(s=n.next(),s.done)break;o=s.value}var l=o;r.push.apply(r,babelHelpers.toConsumableArray(u(e,l,t,a)))}return r}function d(e,t){for(var a=[],r=e.issues,n=Array.isArray(r),i=0,r=n?r:r["function"==typeof Symbol?Symbol.iterator:"@@iterator"]();;){var s;if(n){if(i>=r.length)break;s=r[i++]}else{if(i=r.next(),i.done)break;s=i.value}var o=s,l=t&&t[o.id]||[];a.push.apply(a,babelHelpers.toConsumableArray(_(o,e,l)))}return a}function c(e){return!(!e.selected_option||!e.help_options.find(function(t){return t.value===e.selected_option&&t.on_click&&t.on_click.show===f}))}Object.defineProperty(r,"__esModule",{value:!0}),r.getBotParticipant=n,r.getViewerParticipant=i,r.helpThreadToMessages=d,r.isAttachmentLibraryNode=c;var P=t(379),h=babelHelpers.interopRequireDefault(P),T=t(2225),m=t(2264),b=t(2242),I=babelHelpers.interopRequireWildcard(b),f="attachments_uploader"},2263);