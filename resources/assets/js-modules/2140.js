__d(function(e,t,n,r){function a(){(0,B.trackStatsEarningsMonthPaginatePrevPageEvent)()}function o(){(0,B.trackStatsEarningsMonthPaginateNextPageEvent)()}function i(e){return b.default.priceString(e.amount,e.currency,{thousandsDelimiter:!0})}function s(e){return e?i(e):" "}Object.defineProperty(r,"__esModule",{value:!0});var l=t(412),u=babelHelpers.interopRequireDefault(l),h=t(271),p=babelHelpers.interopRequireDefault(h),c=t(44),f=t(379),d=babelHelpers.interopRequireDefault(f),g=t(377),b=babelHelpers.interopRequireDefault(g),m=t(654),y=t(790),F=t(562),M=babelHelpers.interopRequireDefault(F),v=t(1372),D=babelHelpers.interopRequireDefault(v),H=t(422),E=babelHelpers.interopRequireDefault(H),R=t(773),x=babelHelpers.interopRequireDefault(R),C=t(910),P=babelHelpers.interopRequireDefault(C),T=t(778),q=babelHelpers.interopRequireDefault(T),S=t(821),N=babelHelpers.interopRequireDefault(S),_=t(1840),j=babelHelpers.interopRequireDefault(_),I=t(1066),k=babelHelpers.interopRequireDefault(I),w=t(787),Y=babelHelpers.interopRequireDefault(w),A=t(841),O=babelHelpers.interopRequireDefault(A),G=t(2141),L=t(2143),B=t(2144),U={fetchThenFocusMonthDetails:u.default.func.isRequired,fetchEarningsData:u.default.func.isRequired,resetEarningsPage:u.default.func.isRequired,focusedMonth:u.default.instanceOf(Date),activityStats:u.default.object,hostEarnings:u.default.array,isFetchingMonthDetails:u.default.bool.isRequired,isFetchingEarnings:u.default.bool.isRequired},V=function(e){function t(n,r){babelHelpers.classCallCheck(this,t);var a=babelHelpers.possibleConstructorReturn(this,e.call(this,n,r));return a.handleEarningsGraphFocusChange=a.handleEarningsGraphFocusChange.bind(a),a.handleFocusChangeTap=a.handleFocusChangeTap.bind(a),a}return babelHelpers.inherits(t,e),t.prototype.componentDidMount=function(){this.props.fetchEarningsData()},t.prototype.componentWillUnmount=function(){this.props.resetEarningsPage()},t.prototype.getFocusedMonthName=function(){return(0,M.default)(this.props.focusedMonth).format("MMMM")},t.prototype.getFocusedYearName=function(){return(0,M.default)(this.props.focusedMonth).format("YYYY")},t.prototype.getFocusedMonthYearName=function(){return(0,M.default)(this.props.focusedMonth).format(D.default.format("month_year"))},t.prototype.getEarningsAmountTextSubtitle=function(e){if(this.props.isFetchingEarnings)return null;var t=void 0;return t=d.default.phrase("%{month_name} earnings",{month_name:this.getFocusedMonthName()},"The total amount of earnings for the listing for that month."),t+="\n"+(e&&e.amount>0?d.default.phrase("You\u2019ve been paid out %{amount}",{amount:i(e)},"The amount of money that is already paid out in that month."):d.default.phrase("Nothing paid out yet",null,"No pay out has been made yet to the host"))},t.prototype.getEarningsInfoForFocusedMonth=function(){var e=this.props,t=e.focusedMonth,n=e.hostEarnings;if(!n||n.length<1)return null;var r=t.getFullYear(),a=t.getMonth()+1;return n.find(function(e){return e.year===r&&e.month===a})},t.prototype.getCancellationFeesInfoForFocusedMonth=function(){return(this.getEarningsInfoForFocusedMonth()||{}).cancellationFees},t.prototype.getCancellationFeeDisplayPriceString=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getCancellationFeesInfoForFocusedMonth();return t&&(e||0!==t.amount)?"("+i(babelHelpers.extends({},t,{amount:Math.abs(t.amount)}))+")":null},t.prototype.getInfoProps=function(){var e=[],t=this.props.activityStats,n=t.availableNights,r=t.nightsBooked,a=t.nightsUnbooked,o=t.occupancyRate,s=t.nightsPriceRange,l=t.cleaningFees,u=this.getCancellationFeeDisplayPriceString();if("number"==typeof r&&"number"==typeof n&&e.push({title:d.default.phrase("Nights booked",null,"How many nights are booked in the focused month"),subtitle:d.default.phrase("%{total} total available nights in %{month_year}",{total:n,month_year:this.getFocusedMonthYearName()},"total number of nights that are available for the given month in the given year"),infoText:String(r)}),"number"==typeof a&&e.push({title:d.default.phrase("Unbooked nights",null,"How many nights are not boked in the focused month"),infoText:String(a)}),"number"==typeof o&&e.push({title:d.default.phrase("Occupancy rate",null,"booked night / total number of available nights"),infoText:t.occupancyRate+"%"}),s&&2===s.length){var h=i(s[0]),p=i(s[1]),c=h===p,f=c?d.default.phrase("Nightly Price",null,"The price for all nights in the month"):d.default.phrase("Nightly Price Range",null,"The price range for all nights in the month"),g=c?h:d.default.phrase("%{low_price} - %{high_price}",{low_price:h,high_price:p},"a price range, from low to high");e.push({title:f,infoText:g})}return l&&0!==l.amount&&e.push({title:d.default.phrase("Cleaning fees",null,"The cost of cleaning fees for a month"),infoText:i(t.cleaningFees)}),u&&e.push({title:d.default.phrase("Cancellation fees",null,"The cost caused by cancellation for a month"),subtitle:d.default.phrase("Incurred in %{month_year}",{month_year:this.getFocusedMonthYearName()},"Which year/month did the fee incur"),infoText:u}),e},t.prototype.getDateAtX=function(e){var t=this.props.hostEarnings[e-1],n=new Date;return n.setDate(1),n.setMonth(t.month-1),n.setFullYear(t.year),n},t.prototype.focusOnMonth=function(e){this.props.fetchThenFocusMonthDetails(e)},t.prototype.handleEarningsGraphFocusChange=function(e){this.focusOnMonth(this.getDateAtX(e))},t.prototype.handleFocusChangeTap=function(e){(0,B.trackStatsEarningsSelectMonthEvent)(this.getDateAtX(e))},t.prototype.renderMarquee=function(){var e=this.getEarningsInfoForFocusedMonth(),t=e?e.total:[],n=e?e.paidOut:[],r=t[0],a=n[0],o=s(r),i=this.getEarningsAmountTextSubtitle(a);return babelHelpers.jsx(x.default,{title:o,subtitle:i})},t.prototype.renderAdditionalHeaders=function(){var e=this,t=this.getEarningsInfoForFocusedMonth(),n=t?t.total:[],r=t?t.paidOut:[];return n.slice(1).map(function(t,n){var a=s(t),o=e.getEarningsAmountTextSubtitle(r[n+1]);return babelHelpers.jsx(j.default,{formattedNumberString:a,title:o},n)})},t.prototype.renderEarningsGraph=function(){var e=this.props.hostEarnings;return e&&e[0]?babelHelpers.jsx(q.default,{},void 0,babelHelpers.jsx(k.default,{earningsData:e,yAxisCurrency:e[0].paidOutConverted.currency,onFocusChange:this.handleEarningsGraphFocusChange,onPrevPageButtonPress:a,onNextPageButtonPress:o,onFocusChangePress:this.handleFocusChangeTap})):null},t.prototype.renderInfoRows=function(){return this.getInfoProps().map(function(e){return p.default.createElement(N.default,babelHelpers.extends({key:e.title},e))})},t.prototype.renderMonthDetails=function(){var e=this.props,t=e.isFetchingMonthDetails,n=e.activityStats;return!t&&n?babelHelpers.jsx(q.default,{},void 0,babelHelpers.jsx(P.default,{title:this.getFocusedMonthYearName(),heavy:!0}),this.renderInfoRows()):null},t.prototype.renderLoader=function(){return babelHelpers.jsx(c.View,{style:X.loaderContainer},void 0,babelHelpers.jsx(O.default,{}))},t.prototype.renderMonthDetailsLoader=function(){return babelHelpers.jsx(q.default,{},void 0,babelHelpers.jsx(P.default,{title:""}),this.renderLoader())},t.prototype.render=function(){var e=this.props,t=e.isFetchingEarnings,n=e.isFetchingMonthDetails;return babelHelpers.jsx(c.View,{style:c.StyleSheet.absoluteFill},void 0,babelHelpers.jsx(Y.default,{showsVerticalScrollIndicator:!1,showsHorizontalScrollIndicator:!1},void 0,this.renderMarquee(),this.renderAdditionalHeaders(),t?this.renderLoader():this.renderEarningsGraph(),n?this.renderMonthDetailsLoader():this.renderMonthDetails()))},t}(h.PureComponent);V.propTypes=U;var X=E.default.create(function(e){return{loaderContainer:{padding:4*e.bp,backgroundColor:e.color.white,alignItems:"center"}}});r.default=(0,y.connect)(function(e){return(0,L.earningsSelector)(e)},function(e){return(0,m.bindActionCreators)({fetchThenFocusMonthDetails:G.fetchThenFocusMonthDetails,fetchEarningsData:G.fetchEarningsData,resetEarningsPage:G.resetEarningsPage},e)})(V)},2140);