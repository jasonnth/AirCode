__d(function(e,i,t,o){Object.defineProperty(o,"__esModule",{value:!0});var a=i(759),r=babelHelpers.interopRequireDefault(a),n=i(412),l=babelHelpers.interopRequireDefault(n),s=i(271),d=babelHelpers.interopRequireDefault(s),u=i(654),c=i(1497),I=babelHelpers.interopRequireDefault(c),f=i(379),E=babelHelpers.interopRequireDefault(f),C=i(790),p=i(410),_=babelHelpers.interopRequireDefault(p),b=i(1475),R=babelHelpers.interopRequireWildcard(b),T=i(1490),D=babelHelpers.interopRequireDefault(T),A=i(1498),m=babelHelpers.interopRequireDefault(A),O=i(1499),h=babelHelpers.interopRequireDefault(O),F=i(1500),N=babelHelpers.interopRequireDefault(F),V=i(1501),S=babelHelpers.interopRequireDefault(V),L=i(1470),y=i(1472),v=i(684),M=i(1466),q=i(1443),H=i(1503),g=i(1478),P=function(e){function i(t){babelHelpers.classCallCheck(this,i);var o=babelHelpers.possibleConstructorReturn(this,e.call(this,t));return o.state={isLoading:!1},o.onCloseToast=o.onCloseToast.bind(o),o.setCodeInputScreenRef=o.setCodeInputScreenRef.bind(o),o.onFailedFriction=o.onFailedFriction.bind(o),o.verifyCode=o.verifyCode.bind(o),o.onTryAgain=o.onTryAgain.bind(o),o}return babelHelpers.inherits(i,e),i.prototype.setCodeInputScreenRef=function(e){this.codeInputScreenRef=e},i.prototype.verifyCode=function(e){var i=this,t=this.props,o=t.actionName,a=t.airlockId,r=t.userId,n=t.submitEmailVerificationCode;return(0,t.removeAllToasts)(),(0,I.default)(),(0,g.logSubmitEmailVerificationCode)(a,e),n({actionName:o,airlockId:a,userId:r,code:e}).then(function(e){var t=e.success,o=e.payload;return i.handleSubmissionResult(t,o)})},i.prototype.onTryAgain=function(){var e=this,i=this.props,t=i.actionName,o=i.airlockId,a=i.userId,r=i.requestToSendEmailVerificationCode;(0,g.logSendEmailVerificationCode)(o,g.PAGE_NAMES.EMAIL_CODE_INPUT_SCREEN),r({actionName:t,airlockId:o,userId:a}).then(function(i){var t=i.success,o=i.payload;t||("rate_limit"===o.error_type?e.props.addToast(y.EMAIL_CODE_VERIFICATION_RESEND_CODE_RATE_LIMITED):e.props.addToast(y.EMAIL_CODE_VERIFICATION_RESEND_CODE_FAILED))})},i.prototype.onFailedFriction=function(){this.props.addFailedFriction(M.FRICTION_TYPE_EMAIL_CODE_VERIFICATION)},i.prototype.handleSubmissionResult=function(e,i){return!e||(!0===((i.airlock||{}).friction_statuses||{})[M.FRICTION_TYPE_EMAIL_CODE_VERIFICATION]?((0,I.default)(),_.default.push(q.FRICTION_SUCCESS),!0):(this.props.addToast(y.EMAIL_CODE_VERIFICATION_WRONG_CODE),!1))},i.prototype.onCloseToast=function(){this.props.removeAllToasts(),this.codeInputScreenRef.clearInput(),this.codeInputScreenRef.focus()},i.prototype.render=function(){var e=this.props,i=e.isFetching,t=e.emailCodeVerificationDetail,o=t&&t.obfuscated_email_address;return d.default.createElement(m.default,{ref:this.setCodeInputScreenRef,title:E.default.phrase("Confirm by email",null,"Screen title for the user to input verification code sent to email"),subtitle:E.default.phrase("We sent a verification code to %{emailAddress}. It might take a minute or two for the email to arrive.",{emailAddress:o},"a subtitle explaining where to find the verification code"),hintTryAgain:E.default.phrase("Resend email",null,"the text in a link to send the verification code again"),retryInterval:H.VERIFICATION_CODE_RESEND_INTERVAL_SECONDS,codeLength:H.VERIFICATION_CODE_LENGTH,isLoading:i,funcFailed:this.onFailedFriction,funcTryAgain:this.onTryAgain,funcVerifyCode:this.verifyCode,toasts:[babelHelpers.jsx(S.default,{id:y.EMAIL_CODE_VERIFICATION_WRONG_CODE,onPressClose:this.onCloseToast},y.EMAIL_CODE_VERIFICATION_WRONG_CODE),babelHelpers.jsx(N.default,{id:y.EMAIL_CODE_VERIFICATION_SUBMIT_CODE_FAILED,onPressClose:this.onCloseToast},y.EMAIL_CODE_VERIFICATION_SUBMIT_CODE_FAILED),babelHelpers.jsx(N.default,{id:y.EMAIL_CODE_VERIFICATION_RESEND_CODE_FAILED,onPressClose:this.onCloseToast},y.EMAIL_CODE_VERIFICATION_RESEND_CODE_FAILED),babelHelpers.jsx(h.default,{id:y.EMAIL_CODE_VERIFICATION_RESEND_CODE_RATE_LIMITED,onPressClose:this.onCloseToast},y.EMAIL_CODE_VERIFICATION_RESEND_CODE_RATE_LIMITED)]})},i}(s.PureComponent);P.propTypes={isFetching:l.default.bool,airlockId:l.default.number,actionName:l.default.string,userId:l.default.number,emailCodeVerificationDetail:D.default,selectedPhoneNumberId:l.default.number,addFailedFriction:l.default.func.isRequired,submitEmailVerificationCode:l.default.func.isRequired,requestToSendEmailVerificationCode:l.default.func.isRequired,addToast:l.default.func.isRequired,removeAllToasts:l.default.func.isRequired},P.defaultProps={isFetching:!1,airlockId:null,actionName:null,userId:null,phoneVerificationViaCallDetail:null,phoneVerificationViaTextDetail:null,selectedPhoneNumberId:null},o.default=(0,C.connect)(function(e){return babelHelpers.extends({emailCodeVerificationDetail:(0,L.emailCodeVerificationDetailSelector)(e)},(0,r.default)((0,L.frictionManagerSelector)(e),["airlockId","actionName","userId"]),(0,r.default)((0,L.emailCodeVerificationSelector)(e),["isFetching"]))},function(e){return(0,u.bindActionCreators)({addFailedFriction:R.addFailedFriction,submitEmailVerificationCode:R.submitEmailVerificationCode,requestToSendEmailVerificationCode:R.requestToSendEmailVerificationCode,removeAllToasts:R.removeAllToasts,addToast:v.addToast},e)})(P)},1504);