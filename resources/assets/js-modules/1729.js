__d(function(e,t,i,l){Object.defineProperty(l,"__esModule",{value:!0});var s=t(271),a=babelHelpers.interopRequireDefault(s),r=t(834),o=t(790),p=t(654),n=t(379),d=babelHelpers.interopRequireDefault(n),u=t(44),c=t(841),T=babelHelpers.interopRequireDefault(c),h=t(773),b=babelHelpers.interopRequireDefault(h),m=t(410),f=babelHelpers.interopRequireDefault(m),S=t(778),y=babelHelpers.interopRequireDefault(S),g=t(787),v=babelHelpers.interopRequireDefault(g),R=t(1352),I=babelHelpers.interopRequireDefault(R),_=t(1609),k=t(1730),A=t(789),D=babelHelpers.interopRequireDefault(A),B=t(1731),H=babelHelpers.interopRequireDefault(B),W=t(1733),q=babelHelpers.interopRequireDefault(W),w=t(1736),C=babelHelpers.interopRequireDefault(w),G=t(1573),P=babelHelpers.interopRequireWildcard(G),j=t(1569),E=babelHelpers.interopRequireWildcard(j),x=t(1578),L=t(1575),O={isSheet:r.Types.bool,hasGuests:r.Types.bool,scheduledTripTemplates:r.Types.array.isRequired,selectedScheduledTripTemplate:r.Types.object,showWaitlist:r.Types.bool,tripTemplateId:r.Types.number.isRequired,tripTemplate:r.Types.object.isRequired,loadTripPrice:r.Types.func.isRequired,loadWaitlists:r.Types.func.isRequired,saveBookingData:r.Types.func.isRequired,removeAllAdditionalTravelers:r.Types.func.isRequired},V={isSheet:!1,selectedScheduledTripTemplate:null,showWaitlist:null,hasGuests:!1},F=function(e,t){return{tripTemplate:(0,x.rootSelector)(e).get("tripTemplatesById").get(t.tripTemplateId),scheduledTripTemplates:(0,x.rootSelector)(e).get("scheduledTripTemplatesByTripTemplateId").get(t.tripTemplateId),hasGuests:(0,x.rootSelector)(e).get("bookingData").hasGuests,selectedScheduledTripTemplate:(0,x.rootSelector)(e).get("bookingData").scheduledTripTemplate,showWaitlist:(0,x.rootSelector)(e).get("showWaitlistsByTripTemplateId").get(t.tripTemplateId),waitlistMap:(0,x.rootSelector)(e).get("showWaitlistsByTripTemplateId")}},M=function(e){return(0,p.bindActionCreators)({loadTripPrice:P.loadTripPrice,loadWaitlists:P.loadWaitlists,saveBookingData:P.saveBookingData,removeAllAdditionalTravelers:P.removeAllAdditionalTravelers},e)},N=function(e){function t(i){babelHelpers.classCallCheck(this,t);var l=babelHelpers.possibleConstructorReturn(this,e.call(this,i)),s=l.checkAndGetSelectedScheduledTripTemplate(l.props.selectedScheduledTripTemplate);return l.state={selectedScheduledTripTemplate:s,hasGuests:l.props.hasGuests,buttonRowBottom:new u.Animated.Value(s?-H.default.contentInset.bottom:0)},l.onButtonClick=l.onButtonClick.bind(l),l}return babelHelpers.inherits(t,e),t.prototype.componentDidMount=function(){this.loadTripPrice(),null===this.props.showWaitlist&&this.loadWaitlist()},t.prototype.componentWillReceiveProps=function(e){this.setState({hasGuests:e.hasGuests,selectedScheduledTripTemplate:this.checkAndGetSelectedScheduledTripTemplate(e.selectedScheduledTripTemplate)})},t.prototype.checkAndGetSelectedScheduledTripTemplate=function(e){return e&&this.props.scheduledTripTemplates.some(function(t){return t.id===e.id})?e:null},t.prototype.loadTripPrice=function(){this.props.loadTripPrice({template_id:this.props.tripTemplateId,guest_count:1})},t.prototype.loadWaitlist=function(){this.props.loadWaitlists({template_id:this.props.tripTemplateId})},t.prototype.saveBookingData=function(e,t){var i=this.props,l=i.tripTemplateId,s=i.tripTemplate;this.props.saveBookingData({scheduledTripTemplate:e,hasGuests:t,tripTemplate:s,tripTemplateId:l})},t.prototype.onButtonClick=function(e,t){this.saveBookingData(e,t);var i=this.props,l=i.tripTemplateId,s=i.tripTemplate;t?f.default.push(E.ADDITIONAL_TRAVELERS,{tripTemplateId:l}):(this.props.removeAllAdditionalTravelers(),(0,k.isCuba)(s)?f.default.push(E.CUBA_ATTESTATION_FLOW,{tripTemplateId:l}):f.default.push(E.TRAVEL_REQUIREMENTS,{templateId:l,showBookingFooter:!0,prevStep:"date_picker_plain"}))},t.prototype.slideUpButtonRow=function(){u.Animated.timing(this.state.buttonRowBottom,{toValue:-H.default.contentInset.bottom,duration:250}).start()},t.prototype.renderWaitlistSaveSuccessToast=function(){var e=this.props.tripTemplate,t=e.experience_host_profile.host.first_name;return babelHelpers.jsx(D.default,{},void 0,babelHelpers.jsx(I.default,{id:L.SAVE_WAITLIST_SUCCESS_DATE_PICKER_TOAST,title:d.default.phrase("Great!",null,"congratulations title"),description:d.default.phrase("You\u2019ll be notified once %{hostName} adds more dates.",{hostName:t},"notification message")}))},t.prototype.render=function(){var e=this,t=this.props,i=t.isSheet,l=t.scheduledTripTemplates,s=t.showWaitlist,a=t.tripTemplate,r=a.base_price,o=i?d.default.phrase("%{tripTitle} availability",{tripTitle:a.title},"title for a screen showing a trip\u2019s availability"):d.default.phrase("When do you want to go?",null,"title for a screen showing a trip\u2019s availability");return babelHelpers.jsx(u.View,{style:u.StyleSheet.absoluteFill},void 0,babelHelpers.jsx(v.default,{withInsets:[H.default]},void 0,babelHelpers.jsx(b.default,{title:o}),!l&&babelHelpers.jsx(T.default,{}),babelHelpers.jsx(y.default,{},void 0,l&&l.map(function(t){return babelHelpers.jsx(q.default,{divider:"padded",scheduledTripTemplate:t,tripTemplate:a,onPressBookOne:function(){(0,_.logBookingFlowClickConfirmDates)(r,a,{dates:[t.start_date,t.end_date],singleBooking:!0,spotsLeft:t.remaining_capacity}),e.onButtonClick(t,!1)},onPressBookMore:function(){(0,_.logBookingFlowClickConfirmDates)(r,a,{dates:[t.start_date,t.end_date],singleBooking:!1,spotsLeft:t.remaining_capacity}),e.onButtonClick(t,!0)}},t.id)}),s&&babelHelpers.jsx(C.default,{tripTemplate:a,onPress:function(){f.default.present(E.WAITLIST_DATES,{tripTemplateId:a.id})}}))),a&&this.renderWaitlistSaveSuccessToast())},t}(a.default.Component);N.propTypes=O,N.defaultProps=V,l.default=(0,o.connect)(F,M)(N)},1729);