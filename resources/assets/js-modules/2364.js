__d(function(t,e,a,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n=e(271),r=babelHelpers.interopRequireDefault(n),o=e(44),i=babelHelpers.interopRequireDefault(o),p=e(2365),l=e(2369),c=babelHelpers.interopRequireDefault(l),h=e(2372),u=function(t){function e(a){babelHelpers.classCallCheck(this,e);var s=babelHelpers.possibleConstructorReturn(this,t.call(this,a));return s.state={scale:1,translateX:0,translateY:0,animator:new o.Animated.Value(0),width:0,height:0,pageX:0,pageY:0},s._viewPortRect=new h.Rect,s.cancelAnimation=s.cancelAnimation.bind(s),s.contentRect=s.contentRect.bind(s),s.transformedContentRect=s.transformedContentRect.bind(s),s.animate=s.animate.bind(s),s.scroller=new c.default(!0,function(t,e,a){if(0===t&&0===e&&a.isFinished())return void s.animateBounce();s.updateTransform({translateX:s.state.translateX+t/s.state.scale,translateY:s.state.translateY+e/s.state.scale})}),s}return babelHelpers.inherits(e,t),e.prototype.viewPortRect=function(){return this._viewPortRect.set(0,0,this.state.width,this.state.height),this._viewPortRect},e.prototype.contentRect=function(){var t=this.viewPortRect().copy();return this.props.contentAspectRatio&&this.props.contentAspectRatio>0&&(t=(0,h.fitCenterRect)(this.props.contentAspectRatio,t)),t},e.prototype.transformedContentRect=function(){var t=(0,h.transformedRect)(this.viewPortRect(),this.currentTransform());return this.props.contentAspectRatio&&this.props.contentAspectRatio>0&&(t=(0,h.fitCenterRect)(this.props.contentAspectRatio,t)),t},e.prototype.currentTransform=function(){return new h.Transform(this.state.scale,this.state.translateX,this.state.translateY)},e.prototype.componentWillMount=function(){this.gestureResponder=(0,p.createResponder)({onStartShouldSetResponder:function(t,e){return!0},onMoveShouldSetResponderCapture:function(t,e){return!0},onResponderMove:this.onResponderMove.bind(this),onResponderGrant:this.onResponderGrant.bind(this),onResponderRelease:this.onResponderRelease.bind(this),onResponderTerminate:this.onResponderRelease.bind(this),onResponderTerminationRequest:function(t,e){return!1}})},e.prototype.componentDidUpdate=function(t,e){this.props.onViewTransformed&&this.props.onViewTransformed({scale:this.state.scale,translateX:this.state.translateX,translateY:this.state.translateY})},e.prototype.componentWillUnmount=function(){this.cancelAnimation()},e.prototype.render=function(){var t=this.gestureResponder;return this.props.enableTransform||(t={}),r.default.createElement(o.View,babelHelpers.extends({},this.props,t,{ref:"innerViewRef",onLayout:this.onLayout.bind(this)}),babelHelpers.jsx(o.View,{style:{flex:1,transform:[{scale:this.state.scale},{translateX:this.state.translateX},{translateY:this.state.translateY}]}},void 0,this.props.children))},e.prototype.onLayout=function(t){var e=t.nativeEvent.layout,a=e.width,s=e.height;a===this.state.width&&s===this.state.height||this.setState({width:a,height:s}),this.measureLayout(),this.props.onLayout&&this.props.onLayout(t)},e.prototype.measureLayout=function(){var t=this,e=i.default.findNodeHandle(this.refs.innerViewRef);o.NativeModules.UIManager.measure(e,function(e,a,s,n,r,o){"number"==typeof r&&"number"==typeof o&&(t.state.pageX===r&&t.state.pageY===o||t.setState({pageX:r,pageY:o}))}.bind(this))},e.prototype.onResponderGrant=function(t,e){this.props.onTransformStart&&this.props.onTransformStart(),this.setState({responderGranted:!0}),this.measureLayout()},e.prototype.onResponderMove=function(t,e){this.cancelAnimation();var a=e.moveX-e.previousMoveX,s=e.moveY-e.previousMoveY;if(this.props.enableResistance){var n=this.applyResistance(a,s);a=n.dx,s=n.dy}this.props.enableTranslate||(a=s=0);var r={};if(e.previousPinch&&e.pinch&&this.props.enableScale){var o=e.pinch/e.previousPinch,i=e.moveX-this.state.pageX,p=e.moveY-this.state.pageY,l=(0,h.transformedRect)((0,h.transformedRect)(this.contentRect(),this.currentTransform()),new h.Transform(o,a,s,{x:i,y:p}));r=(0,h.getTransform)(this.contentRect(),l)}else Math.abs(a)>2*Math.abs(s)?s=0:Math.abs(s)>2*Math.abs(a)&&(a=0),r.translateX=this.state.translateX+a/this.state.scale,r.translateY=this.state.translateY+s/this.state.scale;return this.updateTransform(r),!0},e.prototype.onResponderRelease=function(t,e){if(!this.props.onTransformGestureReleased||!this.props.onTransformGestureReleased({scale:this.state.scale,translateX:this.state.translateX,translateY:this.state.translateY}))if(e.doubleTapUp){if(!this.props.enableScale)return void this.animateBounce();var a=0,s=0;e.dx||e.dy?(a=e.moveX-this.state.pageX,s=e.moveY-this.state.pageY):(a=e.x0-this.state.pageX,s=e.y0-this.state.pageY),this.performDoubleTapUp(a,s)}else this.props.enableTranslate?this.performFling(e.vx,e.vy):this.animateBounce()},e.prototype.performFling=function(t,e){var a=void 0,s=void 0,n=void 0,r=void 0,o=(0,h.availableTranslateSpace)(this.transformedContentRect(),this.viewPortRect());t>0?(s=0,a=o.left>0?o.left+this.props.maxOverScrollDistance:0):(a=0,s=o.right>0?-o.right-this.props.maxOverScrollDistance:0),e>0?(r=0,n=o.top>0?o.top+this.props.maxOverScrollDistance:0):(n=0,r=o.bottom>0?-o.bottom-this.props.maxOverScrollDistance:0),t*=1e3,e*=1e3,Math.abs(t)>2*Math.abs(e)?e=0:Math.abs(e)>2*Math.abs(t)&&(t=0),this.scroller.fling(0,0,t,e,s,a,r,n)},e.prototype.performDoubleTapUp=function(t,e){var a=this.state.scale,s=void 0;s=a>(1+this.props.maxScale)/2?1/a:this.props.maxScale/a;var n=(0,h.transformedRect)(this.transformedContentRect(),new h.Transform(s,0,0,{x:t,y:e}));n=(0,h.transformedRect)(n,new h.Transform(1,this.viewPortRect().centerX()-t,this.viewPortRect().centerY()-e)),n=(0,h.alignedRect)(n,this.viewPortRect()),this.animate(n)},e.prototype.applyResistance=function(t,e){var a=(0,h.availableTranslateSpace)(this.transformedContentRect(),this.viewPortRect());return(t>0&&a.left<0||t<0&&a.right<0)&&(t/=3),(e>0&&a.top<0||e<0&&a.bottom<0)&&(e/=3),{dx:t,dy:e}},e.prototype.cancelAnimation=function(){this.state.animator.stopAnimation()},e.prototype.animate=function(t,e){var a=this,s=200;e&&(s=e);var n=this.transformedContentRect();n.equals(t)||(this.state.animator.removeAllListeners(),this.state.animator.setValue(0),this.state.animator.addListener(function(e){var s=e.value,r=n.left+(t.left-n.left)*s,o=n.right+(t.right-n.right)*s,i=n.top+(t.top-n.top)*s,p=n.bottom+(t.bottom-n.bottom)*s,l=(0,h.getTransform)(a.contentRect(),new h.Rect(r,i,o,p));a.updateTransform(l)}),o.Animated.timing(this.state.animator,{toValue:1,duration:s,easing:o.Easing.inOut(o.Easing.ease)}).start())},e.prototype.animateBounce=function(){var t=this.state.scale,e=this.props.maxScale,a=1;t>e?a=e/t:t<1&&(a=1/t);var s=(0,h.transformedRect)(this.transformedContentRect(),new h.Transform(a,0,0,{x:this.viewPortRect().centerX(),y:this.viewPortRect().centerY()}));s=(0,h.alignedRect)(s,this.viewPortRect()),this.animate(s)},e.prototype.updateTransform=function(t){this.setState(t)},e.prototype.forceUpdateTransform=function(t){this.setState(t)},e.prototype.getAvailableTranslateSpace=function(){return(0,h.availableTranslateSpace)(this.transformedContentRect(),this.viewPortRect())},e}(r.default.Component);u.Rect=h.Rect,u.getTransform=h.getTransform,s.default=u,u.propTypes={enableTransform:r.default.PropTypes.bool,enableScale:r.default.PropTypes.bool,enableTranslate:r.default.PropTypes.bool,maxOverScrollDistance:r.default.PropTypes.number,maxScale:r.default.PropTypes.number,contentAspectRatio:r.default.PropTypes.number,enableResistance:r.default.PropTypes.bool,onViewTransformed:r.default.PropTypes.func,onTransformGestureReleased:r.default.PropTypes.func},u.defaultProps={maxOverScrollDistance:20,enableScale:!0,enableTranslate:!0,enableTransform:!0,maxScale:1,enableResistance:!1}},2364);